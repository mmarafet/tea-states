<!doctype html>
<html lang="ru" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ß–∞–π ‚Üí –°–æ—Å—Ç–æ—è–Ω–∏—è</title>

  <style>
    :root{
      /* Light theme */
      --bg: #f6f7fb;
      --card: #ffffff;
      --card2:#fbfcff;
      --text:#0f172a;
      --muted:#5b6578;
      --border: rgba(15,23,42,.12);
      --shadow: 0 10px 28px rgba(15,23,42,.10);

      --btnBg: rgba(15,23,42,.04);
      --btnBgHover: rgba(15,23,42,.07);

      --accent: rgba(13,148,136,.18);
      --accentBorder: rgba(13,148,136,.35);

      --selectBg: #ffffff;
      --selectText: #0f172a;

      --modalBg: rgba(255,255,255,.92);
      --modalBg2: rgba(255,255,255,.86);

      --keepGreenBg1: rgba(13,148,136,.10);
      --keepGreenBg2: rgba(13,148,136,.06);
      --keepGreenBorder: rgba(13,148,136,.45);
      --keepGreenShadow: 0 0 0 6px rgba(13,148,136,.10), 0 14px 30px rgba(15,23,42,.12);
    }

    html[data-theme="dark"]{
      /* Dark theme */
      --bg:#0b0f14;
      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.04);
      --text:#e8eef5;
      --muted:#9aaabb;
      --border: rgba(255,255,255,.12);
      --shadow: 0 10px 30px rgba(0,0,0,.35);

      --btnBg: rgba(255,255,255,.08);
      --btnBgHover: rgba(255,255,255,.12);

      --accent: rgba(125, 211, 252, .14);
      --accentBorder: rgba(125, 211, 252, .28);

      --selectBg: rgba(12,16,22,.95);
      --selectText: #e8eef5;

      --modalBg: rgba(12,16,22,.92);
      --modalBg2: rgba(12,16,22,.86);

      --keepGreenBg1: rgba(167, 243, 208, .12);
      --keepGreenBg2: rgba(167, 243, 208, .08);
      --keepGreenBorder: rgba(167, 243, 208, .35);
      --keepGreenShadow: 0 0 0 6px rgba(167,243,208,.10), 0 14px 30px rgba(0,0,0,.35);
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1100px 700px at 10% 10%, rgba(2,132,199,.10), transparent 55%),
        radial-gradient(900px 650px at 90% 20%, rgba(13,148,136,.08), transparent 50%),
        var(--bg);
    }

    header{
      max-width: 1200px;
      margin: 0 auto;
      padding: 18px 18px 10px;
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
    }
    h1{ margin: 0 0 6px; font-size: 20px; letter-spacing:.2px; }
    .sub{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
      max-width: 820px;
    }

    .topRight{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .langWrap{ display:flex; align-items:center; gap: 8px; }
    .langLabel{ color: var(--muted); font-size: 12px; white-space: nowrap; user-select:none; }
    .langSelect{
      appearance: none;
      -webkit-appearance: none;
      border: 1px solid var(--border);
      background: var(--selectBg);
      color: var(--selectText);
      border-radius: 12px;
      padding: 8px 12px;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,.10);
      outline: none;
    }
    .langSelect:hover{ filter: brightness(1.02); }

    .themeBtn{
      appearance: none;
      -webkit-appearance: none;
      border: 1px solid var(--border);
      background: var(--btnBg);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 12px;
      font-size: 13px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,.10);
      outline: none;
    }
    .themeBtn:hover{ background: var(--btnBgHover); }

    .wrap{
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px 18px 18px;
      display: grid;
      grid-template-columns: 1fr 440px;
      gap: 14px;
      align-items: start;
    }
    @media (max-width: 980px){
      header{ flex-direction: column; align-items: stretch; }
      .topRight{ justify-content: flex-start; }
      .wrap{ grid-template-columns: 1fr; }
    }

    .left{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    @media (max-width: 800px){
      .left{ grid-template-columns: 1fr; }
    }

    .panel, .card, .controls, .footerCard, .nlpCard{
      background: linear-gradient(180deg, var(--card), var(--card2));
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    /* Right card persistent ‚Äúgreenish‚Äù mode */
    .card.keepGreen{
      border-color: var(--keepGreenBorder);
      box-shadow: var(--keepGreenShadow);
      background: linear-gradient(180deg, var(--keepGreenBg1), var(--keepGreenBg2));
    }

    /* Flash animation on NLP pick */
    @keyframes greenFlash {
      0%   { box-shadow: 0 0 0 0 rgba(13,148,136,0.0), var(--shadow); }
      40%  { box-shadow: 0 0 0 10px rgba(13,148,136,0.20), var(--shadow); }
      100% { box-shadow: var(--keepGreenShadow); }
    }
    html[data-theme="dark"] @keyframes greenFlash {
      0%   { box-shadow: 0 0 0 0 rgba(167,243,208,0.0), var(--shadow); }
      40%  { box-shadow: 0 0 0 10px rgba(167,243,208,0.18), var(--shadow); }
      100% { box-shadow: var(--keepGreenShadow); }
    }
    .card.flashGreen{
      animation: greenFlash 900ms ease-out forwards;
    }

    .head{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      display:flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
    }
    html[data-theme="light"] .head{ background: rgba(15,23,42,.02); }
    .title{ font-weight: 800; font-size: 14px; letter-spacing:.2px; }
    .hint{ color: var(--muted); font-size: 12px; white-space: nowrap; }
    .body{ padding: 12px; }

    .legend{
      display:flex;
      gap: 8px;
      flex-wrap: wrap;
      margin: 0 0 10px;
    }
    .pill{
      font-size: 12px;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(255,255,255,.03);
    }
    html[data-theme="light"] .pill{ background: rgba(15,23,42,.03); }

    .cloud{
      display:flex;
      flex-wrap: wrap;
      gap: 8px;
      padding: 2px;
    }
    .node{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 999px;
      cursor: pointer;
      font-size: 13px;
      line-height: 1;
      user-select: none;
      position: relative;
      white-space: nowrap;
      transition: transform .06s ease, border-color .15s ease, background .15s ease;
    }
    html[data-theme="light"] .node{ background: rgba(15,23,42,.03); }
    .node:hover{ border-color: rgba(15,23,42,.20); }
    html[data-theme="dark"] .node:hover{ border-color: rgba(255,255,255,.20); }
    .node:active{ transform: translateY(1px); }

    .node[data-active="true"]{
      border-color: rgba(15,23,42,.35);
      background: rgba(15,23,42,.06);
    }
    html[data-theme="dark"] .node[data-active="true"]{
      border-color: rgba(255,255,255,.35);
      background: rgba(255,255,255,.07);
    }
    .node.bad[data-active="true"]{ border-color: rgba(2,132,199,.55); background: rgba(2,132,199,.10); }
    .node.good[data-active="true"]{ border-color: rgba(13,148,136,.55); background: rgba(13,148,136,.10); }

    .node[data-selected="true"]{
      border-color: rgba(15,23,42,.35);
      background: rgba(15,23,42,.08);
    }
    html[data-theme="dark"] .node[data-selected="true"]{
      border-color: rgba(255,255,255,.35);
      background: rgba(255,255,255,.08);
    }
    .node.bad[data-selected="true"]{ border-color: rgba(2,132,199,.75); background: rgba(2,132,199,.14); }
    .node.good[data-selected="true"]{ border-color: rgba(13,148,136,.75); background: rgba(13,148,136,.14); }

    .checkdot{
      display:none;
      position:absolute;
      right:6px;
      top:50%;
      transform: translateY(-50%);
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: rgba(15,23,42,.55);
      box-shadow: 0 0 0 2px rgba(255,255,255,.25);
    }
    html[data-theme="dark"] .checkdot{
      background: rgba(255,255,255,.65);
      box-shadow: 0 0 0 2px rgba(0,0,0,.25);
    }
    .node[data-selected="true"] .checkdot{ display:block; }

    /* Right card */
    .cardTop{
      padding: 14px;
      border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }
    html[data-theme="light"] .cardTop{ background: rgba(15,23,42,.02); }
    .cardTop h2{
      margin:0;
      font-size: 15px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .chip{
      font-size: 12px;
      border-radius: 999px;
      padding: 5px 9px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(255,255,255,.03);
      white-space: nowrap;
    }
    html[data-theme="light"] .chip{ background: rgba(15,23,42,.03); }

    .cardBody{ padding: 14px; }
    .muted{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
    }
    .divider{ height:1px; background: var(--border); margin: 12px 0; }

    .sectionTitle{
      font-weight: 900;
      font-size: 13px;
      margin: 10px 0 8px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
    }
    .miniBtn{
      border: 1px solid var(--border);
      background: var(--btnBg);
      color: var(--text);
      border-radius: 10px;
      padding: 6px 8px;
      cursor:pointer;
      font-size: 12px;
      white-space: nowrap;
    }
    .miniBtn:hover{ background: var(--btnBgHover); }

    .stateChips{
      display:flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 0 0 8px;
    }
    .stateChip{
      font-size: 12px;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      color: var(--text);
    }
    html[data-theme="light"] .stateChip{ background: rgba(15,23,42,.03); }
    .stateChip.bad{ border-color: rgba(2,132,199,.25); }
    .stateChip.good{ border-color: rgba(13,148,136,.25); }

    .list{ margin: 10px 0 0; padding: 0; list-style: none; }
    .list li{
      padding: 10px 10px;
      border: 1px solid var(--border);
      border-radius: 12px;
      margin-bottom: 8px;
      background: rgba(255,255,255,.03);
    }
    html[data-theme="light"] .list li{ background: rgba(15,23,42,.02); }

    .list li .k{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap:10px;
      margin-bottom: 4px;
      font-weight: 850;
      font-size: 13px;
    }

    /* tea name opens modal */
    .teaBtn{
      all: unset;
      cursor: pointer;
      color: var(--text);
      border-bottom: 1px dashed rgba(15,23,42,.25);
      line-height: 1.2;
    }
    html[data-theme="dark"] .teaBtn{
      border-bottom: 1px dashed rgba(255,255,255,.22);
    }
    .teaBtn:hover{ border-bottom-color: rgba(15,23,42,.55); }
    html[data-theme="dark"] .teaBtn:hover{ border-bottom-color: rgba(255,255,255,.55); }

    .tag{
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: rgba(0,0,0,.02);
      white-space: nowrap;
    }
    html[data-theme="dark"] .tag{ background: rgba(0,0,0,.12); }

    .buyLine{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
      display:flex;
      gap: 8px;
      align-items: baseline;
      flex-wrap: wrap;
    }
    .buyLink{
      color: var(--text);
      text-decoration: none;
      border-bottom: 1px dashed rgba(15,23,42,.22);
      cursor: pointer;
    }
    html[data-theme="dark"] .buyLink{
      border-bottom: 1px dashed rgba(255,255,255,.22);
    }
    .buyLink:hover{ border-bottom-color: rgba(15,23,42,.55); }
    html[data-theme="dark"] .buyLink:hover{ border-bottom-color: rgba(255,255,255,.55); }

    /* AI assistant block (moved above states) */
    .aiTop{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 18px 12px;
    }
    .nlpCard{
      padding: 12px;
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }
    .nlpLeft{
      flex: 1 1 520px;
      min-width: 260px;
    }
    .nlpTitle{ font-weight: 900; font-size: 13px; margin: 0 0 8px; }
    .nlpRow{ display:flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .nlpInput{
      flex: 1 1 420px;
      min-width: 240px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.70);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      outline: none;
      font-size: 13px;
    }
    html[data-theme="dark"] .nlpInput{ background: rgba(255,255,255,.06); }
    .nlpInput:focus{
      border-color: var(--accentBorder);
      box-shadow: 0 0 0 4px var(--accent);
    }
    .primaryBtn{
      border: 1px solid var(--accentBorder);
      background: rgba(13,148,136,.14);
      color: var(--text);
      border-radius: 12px;
      padding: 10px 12px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 800;
      white-space: nowrap;
    }
    html[data-theme="dark"] .primaryBtn{
      background: rgba(125,211,252,.14);
      border-color: rgba(125,211,252,.28);
    }
    .primaryBtn:hover{ filter: brightness(1.05); }
    .nlpNote{ margin: 8px 0 0; color: var(--muted); font-size: 12px; line-height: 1.4; }

    /* Bottom area */
    .below{
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 18px 18px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .controls{
      padding: 12px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
    }
    .controlsLeft{ display:flex; align-items:center; gap: 12px; flex-wrap: wrap; }
    .toggleWrap{ display:flex; align-items:center; gap: 10px; }
    .toggle{
      width: 44px;
      height: 26px;
      border-radius: 999px;
      background: rgba(15,23,42,.10);
      border: 1px solid var(--border);
      position: relative;
      cursor: pointer;
      flex: 0 0 auto;
    }
    html[data-theme="dark"] .toggle{ background: rgba(255,255,255,.12); }
    .toggleKnob{
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: rgba(15,23,42,.55);
      position:absolute;
      top: 50%;
      transform: translateY(-50%);
      left: 2px;
      transition: left .18s ease, background .18s ease;
    }
    html[data-theme="dark"] .toggleKnob{ background: rgba(255,255,255,.75); }
    .toggle[data-on="true"]{
      background: var(--accent);
      border-color: var(--accentBorder);
    }
    .toggle[data-on="true"] .toggleKnob{
      left: 20px;
      background: rgba(13,148,136,.85);
    }
    html[data-theme="dark"] .toggle[data-on="true"] .toggleKnob{
      background: rgba(167, 243, 208, .85);
    }
    .counter{ color: var(--muted); font-size: 12px; white-space: nowrap; }

    /* Footer fineprint + About link */
    .footerCard{ padding: 12px 14px; }
    .fineTopRow{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
    }
    .fineprint{ color: var(--muted); font-size: 12px; line-height: 1.45; }
    .aboutLink{
      font-size: 12px;
      color: var(--text);
      cursor: pointer;
      border-bottom: 1px dashed rgba(15,23,42,.25);
      text-decoration: none;
      user-select:none;
      white-space: nowrap;
    }
    html[data-theme="dark"] .aboutLink{ border-bottom-color: rgba(255,255,255,.22); }
    .aboutLink:hover{ border-bottom-color: rgba(15,23,42,.55); }
    html[data-theme="dark"] .aboutLink:hover{ border-bottom-color: rgba(255,255,255,.55); }

    /* Modals */
    .modalOverlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.45);
      display:none;
      align-items:center;
      justify-content:center;
      z-index: 100;
      padding: 16px;
    }
    .modal{
      width: min(740px, 100%);
      border-radius: 16px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--modalBg), var(--modalBg2));
      box-shadow: var(--shadow);
      overflow: hidden;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .modalTop{
      padding: 14px 14px 10px;
      border-bottom: 1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      background: rgba(255,255,255,.02);
    }
    .modalTop strong{ font-size: 14px; letter-spacing:.2px; }
    .modalBody{
      padding: 14px;
      color: var(--text);
      font-size: 13px;
      line-height: 1.6;
    }
    .modalGrid{ display:grid; grid-template-columns: 1fr; gap: 10px; }
    .modalBlockTitle{ font-weight: 900; margin: 0 0 6px; font-size: 13px; }
    .pillWrap{ display:flex; gap: 6px; flex-wrap: wrap; }
    .pillState{
      font-size: 12px;
      padding: 6px 9px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      color: var(--text);
      user-select:none;
    }
    html[data-theme="light"] .pillState{ background: rgba(15,23,42,.03); }
    .pillState.bad{ border-color: rgba(2,132,199,.25); }
    .pillState.good{ border-color: rgba(13,148,136,.25); }

    .modalActions{
      display:flex;
      justify-content: flex-end;
      gap: 8px;
      padding: 12px 14px;
      border-top: 1px solid var(--border);
      background: rgba(255,255,255,.02);
      flex-wrap: wrap;
    }
    .dangerBtn{
      border: 1px solid rgba(244,63,94,.28);
      background: rgba(244,63,94,.10);
      color: var(--text);
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-size: 12px;
      white-space: nowrap;
    }
    .dangerBtn:hover{ filter: brightness(1.05); }
  </style>
</head>

<body>
<header>
  <div>
    <h1 id="uiTitle">–ß–∞–π ‚Üí –°–æ—Å—Ç–æ—è–Ω–∏—è</h1>
    <p class="sub" id="uiSubtitle">
      –ù–∞–∂–º–∏ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî —Å–ø—Ä–∞–≤–∞ –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. –í —Ä–µ–∂–∏–º–µ PRO –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –¥–æ 5 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–≤—Å–µ–≥–æ –¥–æ 10).
    </p>
  </div>

  <div class="topRight">
    <div class="langWrap">
      <span class="langLabel" id="uiLangLabel">–Ø–∑—ã–∫</span>
      <select class="langSelect" id="langSelect" aria-label="Language selector"></select>
    </div>
    <button class="themeBtn" id="themeBtn" type="button">‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞</button>
  </div>
</header>

<!-- AI assistant moved above states -->
<div class="aiTop">
  <section class="nlpCard">
    <div class="nlpLeft">
      <div class="nlpTitle" id="uiNlpTitle">–û–ø–∏—à–∏ —Å–≤–æ—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –∏ —è –ø–æ–¥–±–µ—Ä—É —á–∞–∏</div>
      <div class="nlpRow">
        <input class="nlpInput" id="nlpInput" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ¬´–ø–æ—Å–ª–µ –æ–±–µ–¥–∞ –∫–ª–æ–Ω–∏—Ç –≤ —Å–æ–Ω, –≥–æ–ª–æ–≤–∞ –≤–∞—Ç–Ω–∞—è, —Ö–æ—á–µ—Ç—Å—è —Å–æ–±—Ä–∞—Ç—å—Å—è –±–µ–∑ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è¬ª" />
        <button class="primaryBtn" id="nlpBtn" type="button">–ü–æ–¥–æ–±—Ä–∞—Ç—å —á–∞–∏</button>
      </div>
      <div class="nlpNote" id="uiNlpNote">
        –†–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–æ 5 ‚Äú—É–±—Ä–∞—Ç—å‚Äù –∏ –¥–æ 5 ‚Äú–≤—ã–∑–≤–∞—Ç—å‚Äù, –∑–∞—Ç–µ–º –≤–∫–ª—é—á–∞–µ—Ç—Å—è PRO –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏—è.
      </div>
    </div>
  </section>
</div>

<div class="wrap">
  <div class="left">
    <section class="panel">
      <div class="head">
        <div class="title" id="uiBadTitle">–°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–π—á–∞—Å (—É–±—Ä–∞—Ç—å)</div>
        <div class="hint" id="uiBadHint">20 —à—Ç.</div>
      </div>
      <div class="body">
        <div class="legend">
          <span class="pill" id="uiBadPill">–í PRO: –∫–ª–∏–∫–∞–π –ø–æ ‚Äú–ø–∏–ª—é–ª—è–º‚Äù –¥–æ 5</span>
        </div>
        <div class="cloud" id="badCloud"></div>
      </div>
    </section>

    <section class="panel">
      <div class="head">
        <div class="title" id="uiGoodTitle">–°–æ—Å—Ç–æ—è–Ω–∏—è —Ö–æ—á—É (–≤—ã–∑–≤–∞—Ç—å)</div>
        <div class="hint" id="uiGoodHint">20 —à—Ç.</div>
      </div>
      <div class="body">
        <div class="legend">
          <span class="pill" id="uiGoodPill1">–£—Ç—Ä–æ ‚Äî ‚Äú–∑–µ–ª–µ–Ω–µ–µ/—Å–≤–µ—Ç–ª–µ–µ‚Äù</span>
          <span class="pill" id="uiGoodPill2">–í–µ—á–µ—Ä ‚Äî ‚Äú—Ç–µ–º–Ω–µ–µ/—Ñ–µ—Ä–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–µ–µ‚Äù</span>
        </div>
        <div class="cloud" id="goodCloud"></div>
      </div>
    </section>
  </div>

  <aside>
    <section class="card" id="rightCard">
      <div class="cardTop">
        <h2 id="cardTitle">–í—ã–±–µ—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ</h2>
        <span class="chip" id="cardChip">–û–¥–∏–Ω –≤—ã–±–æ—Ä</span>
      </div>
      <div class="cardBody">
        <p class="muted" id="cardDesc">
          –í ‚Äú–û–¥–∏–Ω –≤—ã–±–æ—Ä‚Äù ‚Äî –∫–ª–∏–∫ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø–æ–∫–∞–∂–µ—Ç 3‚Äì4 —á–∞—è –¥–ª—è –Ω–µ–≥–æ. –í ‚ÄúPRO‚Äù ‚Äî —Å–ø—Ä–∞–≤–∞ —Å–æ–±–µ—Ä—ë—Ç—Å—è –æ–±—â–∏–π –ø–æ–¥–±–æ—Ä –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
        </p>

        <div id="reasoningBox" style="display:none;">
          <div class="divider"></div>
          <div class="sectionTitle">
            <span id="uiWhy">–ü–æ—á–µ–º—É —Ç–∞–∫</span>
            <button class="miniBtn" id="hideWhyBtn" type="button">—Å–∫—Ä—ã—Ç—å</button>
          </div>
          <div class="muted" id="reasoningText"></div>
        </div>

        <div id="multiBlocks" style="display:none;">
          <div class="divider"></div>

          <div class="sectionTitle">
            <span id="uiAddedRemove">–î–æ–±–∞–≤–ª–µ–Ω–æ: ‚Äú—É–±—Ä–∞—Ç—å‚Äù</span>
            <button class="miniBtn" id="clearBadBtn" type="button">–æ—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
          <div class="stateChips" id="selectedBadChips"></div>

          <div class="sectionTitle">
            <span id="uiAddedGet">–î–æ–±–∞–≤–ª–µ–Ω–æ: ‚Äú–≤—ã–∑–≤–∞—Ç—å‚Äù</span>
            <button class="miniBtn" id="clearGoodBtn" type="button">–æ—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
          <div class="stateChips" id="selectedGoodChips"></div>

          <div class="divider"></div>
          <p class="muted" id="uiMultiLine">
            –í—ã—à–µ ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ù–∏–∂–µ ‚Äî —á–∞–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ —ç—Ç—É –∫–æ–º–±–∏–Ω–∞—Ü–∏—é.
          </p>

          <div class="sectionTitle">
            <span id="uiTeaPick">–ß–∞–π–Ω—ã–π –ø–æ–¥–±–æ—Ä</span>
            <button class="miniBtn" id="clearAllBtn" type="button">—Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë</button>
          </div>
        </div>

        <ul class="list" id="teaList"></ul>

        <div class="divider"></div>
        <p class="muted" id="uiBrewQuick">
          <b>–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–ª–∏–≤–∞:</b><br/>
          120‚Äì150 –º–ª –≥–∞–π–≤–∞–Ω—å/—á–∞–π–Ω–∏–∫ ‚Ä¢ 4‚Äì6 –≥ (–≤–µ—á–µ—Ä–æ–º 3‚Äì5 –≥) ‚Ä¢ –ø—Ä–æ–ª–∏–≤—ã 5‚Äì15 —Å–µ–∫, –¥–∞–ª–µ–µ –ø–æ –≤–∫—É—Å—É.
        </p>
      </div>
    </section>
  </aside>
</div>

<div class="below">
  <!-- Fineprint ABOVE PRO controls -->
  <section class="footerCard">
    <div class="fineTopRow">
      <div class="fineprint" id="uiFineprint">‚ÑπÔ∏è –ù–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–æ–≤–µ—Ç. –†–µ–∞–∫—Ü–∏—è –Ω–∞ —á–∞–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞; —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –∫–æ—Ñ–µ–∏–Ω, –∫—Ä–µ–ø–æ—Å—Ç—å, –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ –∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è. –ü—Ä–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è—Ö, –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏/–ª–∞–∫—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏—ë–º–µ –ª–µ–∫–∞—Ä—Å—Ç–≤ ‚Äî –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º.</div>
      <a class="aboutLink" id="aboutLink" href="javascript:void(0)">–û —Å–∞–π—Ç–µ</a>
    </div>
  </section>

  <!-- PRO controls: only toggle (no extra buttons) -->
  <section class="controls" id="controlsPanel">
    <div class="controlsLeft">
      <div class="toggleWrap">
        <div class="toggle" id="multiToggle" data-on="false" role="switch" aria-checked="false" tabindex="0">
          <div class="toggleKnob"></div>
        </div>
        <div>
          <div style="font-weight:900;" id="uiProTitle">–í—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π PRO</div>
          <div class="counter" id="counterText">–£–±—Ä–∞—Ç—å: 0/5 ‚Ä¢ –í—ã–∑–≤–∞—Ç—å: 0/5</div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- Modal: selection limit -->
<div class="modalOverlay" id="limitModal">
  <div class="modal" role="dialog" aria-modal="true">
    <div class="modalTop">
      <strong id="uiLimitTitle">–õ–∏–º–∏—Ç –≤—ã–±–æ—Ä–∞</strong>
      <button class="miniBtn" id="closeLimitBtn" type="button">–æ–∫</button>
    </div>
    <div class="modalBody" id="uiLimitBody">
      –î–æ 5 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–≤—Å–µ–≥–æ –¥–æ 10—à—Ç), –º–æ–π –¥—Ä—É–≥.
    </div>
  </div>
</div>

<!-- Modal: PRO info (returned when clicking PRO toggle to enable) -->
<div class="modalOverlay" id="proModal">
  <div class="modal" role="dialog" aria-modal="true">
    <div class="modalTop">
      <strong id="uiProModalTitle">–†–µ–∂–∏–º PRO</strong>
      <button class="miniBtn" id="proModalCloseX" type="button">‚úï</button>
    </div>
    <div class="modalBody" id="uiProModalBody">
      –í PRO —Ç—ã –º–æ–∂–µ—à—å –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å—Ä–∞–∑—É: –¥–æ 5 –∏–∑ ‚Äú—É–±—Ä–∞—Ç—å‚Äù –∏ –¥–æ 5 –∏–∑ ‚Äú–≤—ã–∑–≤–∞—Ç—å‚Äù.
      –°–ø—Ä–∞–≤–∞ —Å–æ–±–µ—Ä—ë—Ç—Å—è –æ–±—â–∏–π —á–∞–π–Ω—ã–π –ø–æ–¥–±–æ—Ä –ø–æ–¥ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é.
    </div>
    <div class="modalActions">
      <button class="miniBtn" id="proModalCancel" type="button">–û—Ç–º–µ–Ω–∞</button>
      <button class="primaryBtn" id="proModalEnable" type="button">–í–∫–ª—é—á–∏—Ç—å PRO</button>
    </div>
  </div>
</div>

<!-- Modal: About -->
<div class="modalOverlay" id="aboutModal">
  <div class="modal" role="dialog" aria-modal="true">
    <div class="modalTop">
      <strong id="uiAboutTitle">–û —Å–∞–π—Ç–µ</strong>
      <button class="miniBtn" id="aboutCloseBtn" type="button">–æ–∫</button>
    </div>
    <div class="modalBody" id="uiAboutBody">
      –î–∞–Ω–Ω—ã–π —Å–∞–π—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ GPT-5.2.
      –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –æ–±–æ–±—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –º–µ—Ç–∞-–æ–±–∑–æ—Ä–æ–≤, —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
      –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∞—è (–≤–∫–ª—é—á–∞—è –∫–∏—Ç–∞–π—Å–∫—É—é —á–∞–π–Ω—É—é —Ç—Ä–∞–¥–∏—Ü–∏—é), –∞ —Ç–∞–∫–∂–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–æ–º—É —Å–æ—Å—Ç–∞–≤—É —á–∞—è
      (–∫–æ—Ñ–µ–∏–Ω, L-—Ç–µ–∞–Ω–∏–Ω, –ø–æ–ª–∏—Ñ–µ–Ω–æ–ª—ã) –∏ –∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ–º—É –≤–ª–∏—è–Ω–∏—é –Ω–∞ –±–æ–¥—Ä—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, –≤–Ω–∏–º–∞–Ω–∏–µ, —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ –∏ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ.
      <br/><br/>
      –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ –∏ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã ¬´–Ω–∞ –ø—É—Å—Ç–æ–º –º–µ—Å—Ç–µ¬ª, –æ–¥–Ω–∞–∫–æ –æ–Ω–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
      –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —á–∞–π –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π,
      —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –Ω–∞–ª–∏—á–∏—è –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π, –ø—Ä–∏—ë–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤, –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫, —Å–ø–æ—Å–æ–±–∞ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—è –∏ –¥–æ–∑–∏—Ä–æ–≤–∫–∏.
      <br/><br/>
      –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–µ–π, –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –ª–µ—á–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π
      –∏ –Ω–µ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–º–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤—Ä–∞—á–∞. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π, –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏, –ª–∞–∫—Ç–∞—Ü–∏–∏, –Ω–∞—Ä—É—à–µ–Ω–∏–π —Å–Ω–∞,
      —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–ª–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫ –∫–æ—Ñ–µ–∏–Ω—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º.
      <br/><br/>
      –ò—Å–ø–æ–ª—å–∑—É—è —Å–∞–π—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –æ—Å–æ–∑–Ω–∞—ë—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è
      –æ–± —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ —á–∞—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –ø—Ä–∏–Ω–∏–º–∞—è –Ω–∞ —Å–µ–±—è –≤—Å—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è.
    </div>
  </div>
</div>

<!-- Modal: tea details -->
<div class="modalOverlay" id="teaModal">
  <div class="modal" role="dialog" aria-modal="true">
    <div class="modalTop">
      <strong id="teaModalTitle">–ß–∞–π</strong>
      <button class="miniBtn" id="teaModalCloseBtn" type="button">–æ–∫</button>
    </div>
    <div class="modalBody">
      <div class="modalGrid">
        <div>
          <div class="muted" id="teaModalDesc"></div>
        </div>

        <div>
          <div class="modalBlockTitle" id="teaModalOriginTitle">–ü—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</div>
          <div class="muted" id="teaModalOrigin"></div>
        </div>

        <div>
          <div class="modalBlockTitle" id="teaModalFactsTitle">–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã</div>
          <div class="muted" id="teaModalFacts"></div>
        </div>

        <div>
          <div class="modalBlockTitle" id="teaModalGivesTitle">–ß—Ç–æ –æ–±—ã—á–Ω–æ –¥–∞—ë—Ç</div>
          <div class="pillWrap" id="teaModalGives"></div>
        </div>

        <div>
          <div class="modalBlockTitle" id="teaModalWhenTitle">–ö–æ–≥–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç</div>
          <div class="pillWrap" id="teaModalWhen"></div>
        </div>

        <div>
          <div class="modalBlockTitle" id="teaModalBrewTitle">–ó–∞–≤–∞—Ä–∏–≤–∞–Ω–∏–µ</div>
          <div class="muted" id="teaModalBrew"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // =========================
  // i18n: RU + EN
  // =========================
  const LANGS = [
    { id:"ru", label:"–†—É—Å—Å–∫–∏–π" },
    { id:"en", label:"English" },
  ];

  const UI = {
    ru: {
      title:"–ß–∞–π ‚Üí –°–æ—Å—Ç–æ—è–Ω–∏—è",
      subtitle:"–ù–∞–∂–º–∏ –Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî —Å–ø—Ä–∞–≤–∞ –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏. –í —Ä–µ–∂–∏–º–µ PRO –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –¥–æ 5 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–≤—Å–µ–≥–æ –¥–æ 10).",
      langLabel:"–Ø–∑—ã–∫",
      themeLight:"‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞",
      themeDark:"üåô –¢—ë–º–Ω–∞—è —Ç–µ–º–∞",

      badTitle:"–°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–π—á–∞—Å (—É–±—Ä–∞—Ç—å)", badHint:"20 —à—Ç.", badPill:"–í PRO: –∫–ª–∏–∫–∞–π –ø–æ ‚Äú–ø–∏–ª—é–ª—è–º‚Äù –¥–æ 5",
      goodTitle:"–°–æ—Å—Ç–æ—è–Ω–∏—è —Ö–æ—á—É (–≤—ã–∑–≤–∞—Ç—å)", goodHint:"20 —à—Ç.",
      goodPill1:"–£—Ç—Ä–æ ‚Äî ‚Äú–∑–µ–ª–µ–Ω–µ–µ/—Å–≤–µ—Ç–ª–µ–µ‚Äù", goodPill2:"–í–µ—á–µ—Ä ‚Äî ‚Äú—Ç–µ–º–Ω–µ–µ/—Ñ–µ—Ä–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–µ–µ‚Äù",

      cardIdleTitle:"–í—ã–±–µ—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ",
      cardModeSingle:"–û–¥–∏–Ω –≤—ã–±–æ—Ä",
      cardModePro:"PRO",
      cardDesc:"–í ‚Äú–û–¥–∏–Ω –≤—ã–±–æ—Ä‚Äù ‚Äî –∫–ª–∏–∫ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—é –ø–æ–∫–∞–∂–µ—Ç 3‚Äì4 —á–∞—è –¥–ª—è –Ω–µ–≥–æ. –í ‚ÄúPRO‚Äù ‚Äî —Å–ø—Ä–∞–≤–∞ —Å–æ–±–µ—Ä—ë—Ç—Å—è –æ–±—â–∏–π –ø–æ–¥–±–æ—Ä –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.",

      why:"–ü–æ—á–µ–º—É —Ç–∞–∫",
      hide:"—Å–∫—Ä—ã—Ç—å",

      addedRemove:"–î–æ–±–∞–≤–ª–µ–Ω–æ: ‚Äú—É–±—Ä–∞—Ç—å‚Äù", addedGet:"–î–æ–±–∞–≤–ª–µ–Ω–æ: ‚Äú–≤—ã–∑–≤–∞—Ç—å‚Äù", teaPick:"–ß–∞–π–Ω—ã–π –ø–æ–¥–±–æ—Ä",
      clear:"–æ—á–∏—Å—Ç–∏—Ç—å", resetAll:"—Å–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë",
      multiLine:"–í—ã—à–µ ‚Äî –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ù–∏–∂–µ ‚Äî —á–∞–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ —ç—Ç—É –∫–æ–º–±–∏–Ω–∞—Ü–∏—é.",

      quickBrew:"<b>–ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–ª–∏–≤–∞:</b><br/>120‚Äì150 –º–ª –≥–∞–π–≤–∞–Ω—å/—á–∞–π–Ω–∏–∫ ‚Ä¢ 4‚Äì6 –≥ (–≤–µ—á–µ—Ä–æ–º 3‚Äì5 –≥) ‚Ä¢ –ø—Ä–æ–ª–∏–≤—ã 5‚Äì15 —Å–µ–∫, –¥–∞–ª–µ–µ –ø–æ –≤–∫—É—Å—É.",

      proTitle:"–í—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π PRO",
      counter:(a,b)=>`–£–±—Ä–∞—Ç—å: ${a}/5 ‚Ä¢ –í—ã–∑–≤–∞—Ç—å: ${b}/5`,

      proModalTitle:"–†–µ–∂–∏–º PRO",
      proModalBody:"–í PRO —Ç—ã –º–æ–∂–µ—à—å –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å—Ä–∞–∑—É: –¥–æ 5 –∏–∑ ‚Äú—É–±—Ä–∞—Ç—å‚Äù –∏ –¥–æ 5 –∏–∑ ‚Äú–≤—ã–∑–≤–∞—Ç—å‚Äù. –°–ø—Ä–∞–≤–∞ —Å–æ–±–µ—Ä—ë—Ç—Å—è –æ–±—â–∏–π —á–∞–π–Ω—ã–π –ø–æ–¥–±–æ—Ä –ø–æ–¥ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é.",
      proModalEnable:"–í–∫–ª—é—á–∏—Ç—å PRO",
      proModalCancel:"–û—Ç–º–µ–Ω–∞",

      nlpTitle:"–û–ø–∏—à–∏ —Å–≤–æ—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –∏ —è –ø–æ–¥–±–µ—Ä—É —á–∞–∏",
      nlpPlaceholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: ¬´–ø–æ—Å–ª–µ –æ–±–µ–¥–∞ –∫–ª–æ–Ω–∏—Ç –≤ —Å–æ–Ω, –≥–æ–ª–æ–≤–∞ –≤–∞—Ç–Ω–∞—è, —Ö–æ—á–µ—Ç—Å—è —Å–æ–±—Ä–∞—Ç—å—Å—è –±–µ–∑ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è¬ª",
      nlpBtn:"–ü–æ–¥–æ–±—Ä–∞—Ç—å —á–∞–∏",
      nlpNote:"–†–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–æ 5 ‚Äú—É–±—Ä–∞—Ç—å‚Äù –∏ –¥–æ 5 ‚Äú–≤—ã–∑–≤–∞—Ç—å‚Äù, –∑–∞—Ç–µ–º –≤–∫–ª—é—á–∞–µ—Ç—Å—è PRO –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏—è.",

      prompts:{
        bad:"–ü–æ–¥ —ç—Ç–∏ –æ—â—É—â–µ–Ω–∏—è —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—Ç:",
        good:"–ß—Ç–æ–±—ã —É—Å–∏–ª–∏—Ç—å —ç—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –ø–æ–ø—Ä–æ–±—É–π:",
        proTitle:"–ü–æ–¥–±–æ—Ä –ø–æ–¥ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è",
        proDesc:"–ù–∏–∂–µ ‚Äî —á–∞–∏, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ —ç—Ç—É –∫–æ–º–±–∏–Ω–∞—Ü–∏—é."
      },

      fineprint:"‚ÑπÔ∏è –ù–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Å–æ–≤–µ—Ç. –†–µ–∞–∫—Ü–∏—è –Ω–∞ —á–∞–π –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞; —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –∫–æ—Ñ–µ–∏–Ω, –∫—Ä–µ–ø–æ—Å—Ç—å, –≤—Ä–µ–º—è —Å—É—Ç–æ–∫ –∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è. –ü—Ä–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è—Ö, –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏/–ª–∞–∫—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏—ë–º–µ –ª–µ–∫–∞—Ä—Å—Ç–≤ ‚Äî –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º.",
      about:"–û —Å–∞–π—Ç–µ",

      aboutTitle:"–û —Å–∞–π—Ç–µ",
      aboutBody:`–î–∞–Ω–Ω—ã–π —Å–∞–π—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ GPT-5.2. –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –æ–±–æ–±—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –º–µ—Ç–∞-–æ–±–∑–æ—Ä–æ–≤, —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∞—è (–≤–∫–ª—é—á–∞—è –∫–∏—Ç–∞–π—Å–∫—É—é —á–∞–π–Ω—É—é —Ç—Ä–∞–¥–∏—Ü–∏—é), –∞ —Ç–∞–∫–∂–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π, –ø–æ—Å–≤—è—â—ë–Ω–Ω—ã—Ö —Ö–∏–º–∏—á–µ—Å–∫–æ–º—É —Å–æ—Å—Ç–∞–≤—É —á–∞—è (–∫–æ—Ñ–µ–∏–Ω, L-—Ç–µ–∞–Ω–∏–Ω, –ø–æ–ª–∏—Ñ–µ–Ω–æ–ª—ã) –∏ –∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ–º—É –≤–ª–∏—è–Ω–∏—é –Ω–∞ –±–æ–¥—Ä—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, –≤–Ω–∏–º–∞–Ω–∏–µ, —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ –∏ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ.

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º–∏ –∏ –Ω–µ —Å–æ–∑–¥–∞–Ω—ã ¬´–Ω–∞ –ø—É—Å—Ç–æ–º –º–µ—Å—Ç–µ¬ª, –æ–¥–Ω–∞–∫–æ –æ–Ω–∏ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞. –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —á–∞–π –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π, —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –Ω–∞–ª–∏—á–∏—è –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π, –ø—Ä–∏—ë–º–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤, –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫, —Å–ø–æ—Å–æ–±–∞ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏—è –∏ –¥–æ–∑–∏—Ä–æ–≤–∫–∏.

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ —Å–∞–π—Ç–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–µ–π, –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –ª–µ—á–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏ –Ω–µ –¥–æ–ª–∂–Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–º–µ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤—Ä–∞—á–∞. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π, –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏, –ª–∞–∫—Ç–∞—Ü–∏–∏, –Ω–∞—Ä—É—à–µ–Ω–∏–π —Å–Ω–∞, —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–ª–∏ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫ –∫–æ—Ñ–µ–∏–Ω—É —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º.

–ò—Å–ø–æ–ª—å–∑—É—è —Å–∞–π—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –æ—Å–æ–∑–Ω–∞—ë—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –æ–± —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ —á–∞—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –ø—Ä–∏–Ω–∏–º–∞—è –Ω–∞ —Å–µ–±—è –≤—Å—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è.`,

      limitTitle:"–õ–∏–º–∏—Ç –≤—ã–±–æ—Ä–∞",
      limitBody:"–î–æ 5 —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–≤—Å–µ–≥–æ –¥–æ 10—à—Ç), –º–æ–π –¥—Ä—É–≥.",
      ok:"–æ–∫",

      buy:"–∫—É–ø–∏—Ç—å",

      teaModal:{
        originTitle:"–ü—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ",
        factsTitle:"–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã",
        givesTitle:"–ß—Ç–æ –æ–±—ã—á–Ω–æ –¥–∞—ë—Ç",
        whenTitle:"–ö–æ–≥–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç",
        brewTitle:"–ó–∞–≤–∞—Ä–∏–≤–∞–Ω–∏–µ",
      }
    },

    en: {
      title:"Tea ‚Üí States",
      subtitle:"Click a state ‚Äî recommendations appear on the right. In PRO mode you can pick up to 5 states from each list (10 total).",
      langLabel:"Language",
      themeLight:"‚òÄÔ∏è Light theme",
      themeDark:"üåô Dark theme",

      badTitle:"Current states (reduce)", badHint:"20", badPill:"In PRO: pick up to 5",
      goodTitle:"Desired states (evoke)", goodHint:"20",
      goodPill1:"Morning ‚Äî ‚Äúgreener/lighter‚Äù", goodPill2:"Evening ‚Äî ‚Äúdarker/more fermented‚Äù",

      cardIdleTitle:"Pick a state",
      cardModeSingle:"Single",
      cardModePro:"PRO",
      cardDesc:"Single mode: click a state to see 3‚Äì4 teas. PRO mode aggregates recommendations for selected states.",

      why:"Why",
      hide:"hide",

      addedRemove:"Selected: ‚Äúreduce‚Äù", addedGet:"Selected: ‚Äúevoke‚Äù", teaPick:"Tea recommendations",
      clear:"clear", resetAll:"reset all",
      multiLine:"Above ‚Äî selected states. Below ‚Äî teas that most often fit this combination.",

      quickBrew:"<b>Quick gongfu setup:</b><br/>120‚Äì150 ml gaiwan/pot ‚Ä¢ 4‚Äì6 g (evening 3‚Äì5 g) ‚Ä¢ 5‚Äì15 s infusions, then adjust.",

      proTitle:"Select multiple states PRO",
      counter:(a,b)=>`Reduce: ${a}/5 ‚Ä¢ Evoke: ${b}/5`,

      proModalTitle:"PRO mode",
      proModalBody:"In PRO you can select multiple states: up to 5 ‚Äúreduce‚Äù and up to 5 ‚Äúevoke‚Äù. The right panel will aggregate tea suggestions for the combination.",
      proModalEnable:"Enable PRO",
      proModalCancel:"Cancel",

      nlpTitle:"Describe your state in your own words and I‚Äôll pick teas",
      nlpPlaceholder:"E.g. ‚Äúafter lunch I get sleepy, brain fog, want calm focus without stress‚Äù",
      nlpBtn:"Pick teas",
      nlpNote:"Runs locally in your browser: keywords map to up to 5 ‚Äúreduce‚Äù + 5 ‚Äúevoke‚Äù, then PRO turns on with reasoning.",

      prompts:{
        bad:"These teas often fit this feeling:",
        good:"To amplify this state, try:",
        proTitle:"Recommendations for selected states",
        proDesc:"Below are teas that most often fit this combination."
      },

      fineprint:"‚ÑπÔ∏è Not medical advice. Tea effects are individual; consider caffeine, strength, timing, and contraindications. If you have conditions, are pregnant/breastfeeding, or take medication ‚Äî consult a professional.",
      about:"About",

      aboutTitle:"About",
      aboutBody:`This site uses recommendations generated with the GPT-5.2 AI model. The analysis is based on aggregations of open scientific sources, meta-reviews, traditional tea classification systems (including Chinese tea tradition), and modern research on tea chemistry (caffeine, L-theanine, polyphenols) and their possible influence on alertness, attention, relaxation, and subjective well-being.

These correspondences are not arbitrary, but they also do not guarantee a specific outcome for any particular person. Individual response to tea can vary greatly depending on physiology, nervous system state, medical conditions, medications, time of day, brewing method, and dosage.

This information is not medical advice and is not intended for diagnosis, treatment, or prevention of disease and should not replace a clinician‚Äôs guidance. If you have chronic conditions, are pregnant/breastfeeding, have sleep or cardiovascular issues, or are sensitive to caffeine, consider consulting a professional.

By using the site, you acknowledge the experimental and advisory nature of the information and take full responsibility for your own decisions.`,

      limitTitle:"Selection limit",
      limitBody:"Up to 5 states from each list (10 total), my friend.",
      ok:"OK",

      buy:"buy",

      teaModal:{
        originTitle:"Origin",
        factsTitle:"Fun facts",
        givesTitle:"Typically gives",
        whenTitle:"Often recommended when",
        brewTitle:"Brewing",
      }
    }
  };

  // =========================
  // Tea dictionary + metadata
  // =========================
  const TEA = {
    shu:        {key:"shu",        q:"—à—É –ø—É—ç—Ä —á–∞–π",        name:{ru:"–®—É –ø—É—ç—Ä", en:"Shu pu-erh"}, tag:{ru:"‚Üì –∑–∞–∑–µ–º–ª—è–µ—Ç", en:"‚Üì grounding"}, brew:{ru:"4‚Äì5 –≥ / 120‚Äì150 –º–ª ‚Ä¢ 6‚Äì8 –ø—Ä–æ–ª–∏–≤–æ–≤ ‚Ä¢ –≤–µ—á–µ—Ä–æ–º –Ω–µ –∫—Ä–µ–ø–∫–æ", en:"4‚Äì5 g / 120‚Äì150 ml ‚Ä¢ 6‚Äì8 infusions ‚Ä¢ keep light in the evening"} },
    chaTou:     {key:"chaTou",     q:"–ª–∞–æ —á–∞ —Ç–æ—É –ø—É—ç—Ä",    name:{ru:"–õ–∞–æ –ß–∞ –¢–æ—É (–ø—É—ç—Ä–Ω—ã–µ ‚Äú–∫–∞–º—É—à–∫–∏‚Äù)", en:"Lao Cha Tou (pu-erh nuggets)"}, tag:{ru:"‚Üì –º—è–≥–∫–æ —É—Å–ø–æ–∫–∞–∏–≤–∞–µ—Ç", en:"‚Üì gentle calm"}, brew:{ru:"5‚Äì6 –≥ ‚Ä¢ –¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ –ø—Ä–æ–ª–∏–≤–æ–≤ ‚Ä¢ –ø–æ–∑–¥–Ω–∏–º –≤–µ—á–µ—Ä–æ–º ‚Äî —Ç–æ–ø", en:"5‚Äì6 g ‚Ä¢ many infusions ‚Ä¢ great late evening (light)"} },
    liuBao:     {key:"liuBao",     q:"–ª—é –±–∞–æ —Ö—ç–π —á–∞",      name:{ru:"–õ—é –ë–∞–æ (—Ö—ç–π —á–∞)", en:"Liu Bao (hei cha)"}, tag:{ru:"‚Üì —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç", en:"‚Üì stabilizes"}, brew:{ru:"4‚Äì6 –≥ ‚Ä¢ 6‚Äì10 –ø—Ä–æ–ª–∏–≤–æ–≤ ‚Ä¢ —Ö–æ—Ä–æ—à–æ –ø–æ—Å–ª–µ –µ–¥—ã", en:"4‚Äì6 g ‚Ä¢ 6‚Äì10 infusions ‚Ä¢ great after food"} },
    fuZhuan:    {key:"fuZhuan",    q:"—Ñ—É —á–∂—É–∞–Ω—å —á–∞–π",      name:{ru:"–§—É –ß–∂—É–∞–Ω—å (—Ö—ç–π —á–∞)", en:"Fu Zhuan (hei cha)"}, tag:{ru:"‚Üì —Ä–æ–≤–Ω—ã–π —Ñ–æ–Ω", en:"‚Üì steady baseline"}, brew:{ru:"4‚Äì6 –≥ ‚Ä¢ 6‚Äì10 –ø—Ä–æ–ª–∏–≤–æ–≤ ‚Ä¢ –º—è–≥–∫–æ –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ", en:"4‚Äì6 g ‚Ä¢ 6‚Äì10 infusions ‚Ä¢ smooth and long"} },
    agedWhite:  {key:"agedWhite",  q:"–≤—ã–¥–µ—Ä–∂–∞–Ω–Ω—ã–π –±–µ–ª—ã–π —á–∞–π –ª–∞–æ –±–∞–π —á–∞", name:{ru:"–í—ã–¥–µ—Ä–∂–∞–Ω–Ω—ã–π –±–µ–ª—ã–π (–õ–∞–æ –ë–∞–π –ß–∞)", en:"Aged white tea"}, tag:{ru:"~ —Ç–∏—Ö–∏–π", en:"~ gentle"}, brew:{ru:"4‚Äì5 –≥ ‚Ä¢ 5‚Äì8 –ø—Ä–æ–ª–∏–≤–æ–≤ ‚Ä¢ –º—è–≥–∫–æ, —á–∏—Å—Ç–æ", en:"4‚Äì5 g ‚Ä¢ 5‚Äì8 infusions ‚Ä¢ soft & clean"} },
    white:      {key:"white",      q:"–±–µ–ª—ã–π —á–∞–π –±–∞–π –º—É –¥–∞–Ω—å –∏–Ω—å —á–∂—ç–Ω—å",  name:{ru:"–ë–µ–ª—ã–π —á–∞–π (–ë–∞–π –ú—É –î–∞–Ω—å / –ò–Ω—å –ß–∂—ç–Ω—å)", en:"White tea"}, tag:{ru:"‚Üë –º—è–≥–∫–æ", en:"‚Üë soft lift"}, brew:{ru:"4‚Äì5 –≥ ‚Ä¢ 80‚Äì90¬∞C ‚Ä¢ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–ª–∏–≤—ã", en:"4‚Äì5 g ‚Ä¢ 80‚Äì90¬∞C ‚Ä¢ short infusions"} },
    hongCha:    {key:"hongCha",    q:"–∫—Ä–∞—Å–Ω—ã–π —á–∞–π —Ö—É–Ω —á–∞", name:{ru:"–ö—Ä–∞—Å–Ω—ã–π —á–∞–π (–•—É–Ω –ß–∞)", en:"Black tea (hong cha)"}, tag:{ru:"‚Üí —Ç—ë–ø–ª—ã–π —Ñ–æ–∫—É—Å", en:"‚Üí warm focus"}, brew:{ru:"4‚Äì6 –≥ ‚Ä¢ 4‚Äì7 –ø—Ä–æ–ª–∏–≤–æ–≤ ‚Ä¢ –±–æ–¥—Ä–∏—Ç –º—è–≥–∫–æ", en:"4‚Äì6 g ‚Ä¢ 4‚Äì7 infusions ‚Ä¢ gentle energy"} },
    green:      {key:"green",      q:"–∑–µ–ª—ë–Ω—ã–π —á–∞–π –ª—É–Ω—Ü–∑–∏–Ω", name:{ru:"–ó–µ–ª—ë–Ω—ã–π (–õ—É–Ω—Ü–∑–∏–Ω –∏ –¥—Ä.)", en:"Green tea"}, tag:{ru:"‚Üë‚Üë —è—Å–Ω–æ—Å—Ç—å", en:"‚Üë‚Üë clarity"}, brew:{ru:"3‚Äì4 –≥ ‚Ä¢ 70‚Äì85¬∞C ‚Ä¢ –Ω–µ –ø–µ—Ä–µ–¥–µ—Ä–∂–∏–≤–∞—Ç—å", en:"3‚Äì4 g ‚Ä¢ 70‚Äì85¬∞C ‚Ä¢ don‚Äôt oversteep"} },
    lightOolong:{key:"lightOolong",q:"—Ç–µ –≥—É–∞–Ω—å –∏–Ω—å —É–ª—É–Ω",  name:{ru:"–°–≤–µ—Ç–ª—ã–π —É–ª—É–Ω (–¢–µ –ì—É–∞–Ω—å –ò–Ω—å)", en:"Light oolong"}, tag:{ru:"‚Üë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", en:"‚Üë mood"}, brew:{ru:"5‚Äì6 –≥ ‚Ä¢ 85‚Äì95¬∞C ‚Ä¢ 6‚Äì10 –ø—Ä–æ–ª–∏–≤–æ–≤", en:"5‚Äì6 g ‚Ä¢ 85‚Äì95¬∞C ‚Ä¢ 6‚Äì10 infusions"} },
    darkOolong: {key:"darkOolong", q:"–¥–∞ —Ö—É–Ω –ø–∞–æ —É–ª—É–Ω",    name:{ru:"–¢—ë–º–Ω—ã–π —É–ª—É–Ω (–£–∏: –î–∞ –•—É–Ω –ü–∞–æ)", en:"Dark oolong (Wuyi)"}, tag:{ru:"‚Üí/‚Üì –≥–ª—É–±–∏–Ω–∞", en:"‚Üí/‚Üì depth"}, brew:{ru:"5‚Äì6 –≥ ‚Ä¢ 95‚Äì100¬∞C ‚Ä¢ 6‚Äì10 –ø—Ä–æ–ª–∏–≤–æ–≤", en:"5‚Äì6 g ‚Ä¢ 95‚Äì100¬∞C ‚Ä¢ 6‚Äì10 infusions"} },
    sheng:      {key:"sheng",      q:"—à–µ–Ω –ø—É—ç—Ä —á–∞–π",       name:{ru:"–®—ç–Ω –ø—É—ç—Ä (—Å—ã—Ä–æ–π)", en:"Sheng pu-erh"}, tag:{ru:"‚Üë‚Üë –±–æ–¥—Ä–∏—Ç", en:"‚Üë‚Üë energizing"}, brew:{ru:"4‚Äì6 –≥ ‚Ä¢ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–ª–∏–≤—ã ‚Ä¢ –ª—É—á—à–µ –¥–æ 14:00", en:"4‚Äì6 g ‚Ä¢ short infusions ‚Ä¢ best before 2pm"} },
    yancha:     {key:"yancha",     q:"—è–Ω—å—á–∞ —É–∏—à–∞–Ω—å —É–ª—É–Ω",  name:{ru:"–Ø–Ω—å—á–∞ (—É—Ç—ë—Å–Ω—ã–µ —É–ª—É–Ω—ã –£–∏)", en:"Yancha (Wuyi rock oolong)"}, tag:{ru:"‚Üí –≥–ª—É–±–æ–∫–∏–π —Ñ–æ–∫—É—Å", en:"‚Üí deep focus"}, brew:{ru:"5‚Äì6 –≥ ‚Ä¢ –∫–∏–ø—è—Ç–æ–∫ ‚Ä¢ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–ª–∏–≤—ã", en:"5‚Äì6 g ‚Ä¢ boiling water ‚Ä¢ short infusions"} }
  };

  // IMPORTANT: These are short, ‚Äúsafe‚Äù descriptions: no hard claims, and ‚Äúaltitude‚Äù is given as typical ranges.
  const TEA_META = {
    shu: {
      firstMention:{ ru:"–ö–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è ¬´—à—É¬ª –æ—Ñ–æ—Ä–º–∏–ª—Å—è –≤ –∫–æ–Ω—Ü–µ XX –≤–µ–∫–∞ (—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–π —Ñ–µ—Ä–º–µ–Ω—Ç–∞—Ü–∏–∏).", en:"As a distinct ‚Äúshu‚Äù category it formed in the late 20th century (accelerated fermentation process)." },
      geography:{ ru:"–Æ–Ω—å–Ω–∞–Ω—å, –ö–∏—Ç–∞–π (—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ ‚Äî –ü—É—ç—Ä/–°–∏—à—É–∞–Ω–±–∞–Ω—å–Ω–∞ –∏ —Å–æ—Å–µ–¥–Ω–∏–µ —Ä–∞–π–æ–Ω—ã).", en:"Yunnan, China (often Pu‚Äôer/Xishuangbanna and nearby areas)." },
      altitude:{ ru:"–û–±—ã—á–Ω–æ —Å—ã—Ä—å—ë –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –æ—Ç ~800 –¥–æ ~2000 –º (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–≥–∏–æ–Ω–∞ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–∞–¥–∞).", en:"Leaf material often comes from ~800‚Äì2000 m (varies by region and garden)." },
      facts:{ ru:["–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è ¬´–≤–æ–¥—É–π¬ª –ø—Ä–∏–¥—É–º–∞–Ω–∞, —á—Ç–æ–±—ã –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å –≤–∫—É—Å –≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–≥–æ –ø—É—ç—Ä–∞ –∑–∞ –º–µ—Å—è—Ü—ã/–≥–æ–¥—ã, –∞ –Ω–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è.","–ö—Ä–µ–ø–∫–∞—è –∑–∞–≤–∞—Ä–∫–∞ –º–æ–∂–µ—Ç –∑–∞–º–µ—Ç–Ω–æ –±–æ–¥—Ä–∏—Ç—å, —Ö–æ—Ç—è –ø—Ä–æ—Ñ–∏–ª—å —á–∞—Å—Ç–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ ¬´–∑–∞–∑–µ–º–ª—è—é—â–∏–π¬ª.","–ê—Ä–æ–º–∞—Ç–∏–∫–∞ —É —à—É —á–∞—Å—Ç–æ —É—Ö–æ–¥–∏—Ç –≤ –¥—Ä–µ–≤–µ—Å–Ω–æ-–æ—Ä–µ—Ö–æ–≤—ã–µ, —à–æ–∫–æ–ª–∞–¥–Ω—ã–µ, ¬´–∑–µ–º–ª–∏—Å—Ç—ã–µ¬ª –æ—Ç—Ç–µ–Ω–∫–∏."],
             en:["The ‚Äúwo dui‚Äù process was created to emulate aged pu-erh flavor in months/years rather than decades.","Brewed strong it can be quite energizing, even if the feel is often described as grounding.","Aromas commonly lean woody/nutty, cocoa-like, and earthy."] }
    },
    chaTou: {
      firstMention:{ ru:"¬´–ß–∞ —Ç–æ—É¬ª —Å–≤—è–∑—ã–≤–∞—é—Ç —Å –ø—É—ç—Ä–Ω—ã–º –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ–º (—É–ø–ª–æ—Ç–Ω–∏–≤—à–∏–µ—Å—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã) –∏ –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª—é–±–∏–ª–∏ –≤ –∫–æ–Ω—Ü–µ XX ‚Äî –Ω–∞—á–∞–ª–µ XXI –≤–µ–∫–∞.", en:"‚ÄúCha tou‚Äù is tied to pu-erh production (compressed nuggets) and became especially popular in the late 20th‚Äìearly 21st century." },
      geography:{ ru:"–Æ–Ω—å–Ω–∞–Ω—å, –ö–∏—Ç–∞–π (–≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —É —Ä–∞–∑–Ω—ã—Ö –ø—É—ç—Ä–Ω—ã—Ö —Ñ–∞–±—Ä–∏–∫/–º–∞—Å—Ç–µ—Ä—Å–∫–∏—Ö).", en:"Yunnan, China (produced by various pu-erh makers)." },
      altitude:{ ru:"–ö–∞–∫ –∏ —É –ø—É—ç—Ä–∞: —á–∞—Å—Ç–æ ~800‚Äì2000 –º (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—ã—Ä—å—è).", en:"Similar to pu-erh: often ~800‚Äì2000 m depending on leaf origin." },
      facts:{ ru:["¬´–ö–∞–º—É—à–∫–∏¬ª —á–∞—Å—Ç–æ –≤—ã–¥–µ—Ä–∂–∏–≤–∞—é—Ç –º–Ω–æ–≥–æ –ø—Ä–æ–ª–∏–≤–æ–≤ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—Ç—Å—è.","–ò–∑-–∑–∞ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏—Ö —É–¥–æ–±–Ω–æ –∑–∞–≤–∞—Ä–∏–≤–∞—Ç—å –≤ –¥–æ—Ä–æ–∂–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.","–ü—Ä–æ—Ñ–∏–ª—å –æ–±—ã—á–Ω–æ –º—è–≥—á–µ –∏ ¬´—Ä–æ–≤–Ω–µ–µ¬ª, –µ—Å–ª–∏ –Ω–µ –∑–∞–≤—ã—à–∞—Ç—å –¥–æ–∑–∏—Ä–æ–≤–∫—É."],
             en:["Nuggets can handle many infusions and open gradually.","Their density makes them travel-friendly for gongfu brewing.","The feel is often smoother and steadier when not overdosed."] }
    },
    liuBao: {
      firstMention:{ ru:"–õ—é –ë–∞–æ –æ–ø–∏—Å—ã–≤–∞—é—Ç –∫–∞–∫ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ö—ç–π —á–∞ –∏–∑ –ì—É–∞–Ω—Å–∏; –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö —É–ø–æ–º–∏–Ω–∞—é—Ç —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏ ¬´–≤ —é–∂–Ω—ã–µ –º–æ—Ä—è¬ª –≤ –ø—Ä–æ—à–ª–æ–º.", en:"Liu Bao is a historically known Guangxi hei cha; sources often mention its old trade routes to Southeast Asia." },
      geography:{ ru:"–ì—É–∞–Ω—Å–∏, –ö–∏—Ç–∞–π (—É–µ–∑–¥ –¶–∞–Ω—ä—É / –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ –£—á–∂–æ—É).", en:"Guangxi, China (Cangwu / Wuzhou area)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~200‚Äì1200 –º (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–µ—Å—Ç–Ω–æ—Å—Ç–∏).", en:"Often ~200‚Äì1200 m depending on the exact locale." },
      facts:{ ru:["–ß–∞—Å—Ç–æ –ª—é–±—è—Ç –∑–∞ ¬´—Ç—ë–ø–ª—ã–π¬ª –ø—Ä–æ—Ñ–∏–ª—å –∏ –∫–æ–º—Ñ–æ—Ä—Ç –ø–æ—Å–ª–µ –µ–¥—ã.","–£ –≤—ã–¥–µ—Ä–∂–∞–Ω–Ω—ã—Ö –ø–∞—Ä—Ç–∏–π –º–æ–∂–µ—Ç –ø—Ä–æ—è–≤–ª—è—Ç—å—Å—è –∫–∞–º—Ñ–æ—Ä–Ω–æ—Å—Ç—å/—Å—É—Ö–æ—Ñ—Ä—É–∫—Ç—ã.","–í–∫—É—Å –æ–±—ã—á–Ω–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≥–ª—É–±–∂–µ –∏ —á–∏—â–µ –ø–æ –º–µ—Ä–µ –≤—ã–¥–µ—Ä–∂–∫–∏."],
             en:["Often appreciated for a warm, post-meal friendly profile.","Aged batches may show camphor/dried-fruit notes.","Flavor can become deeper and cleaner with aging."] }
    },
    fuZhuan: {
      firstMention:{ ru:"–§—É –ß–∂—É–∞–Ω—å –æ—Ç–Ω–æ—Å—è—Ç –∫ —Ç—Ä–∞–¥–∏—Ü–∏—è–º —Ö—ç–π —á–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ö–∏—Ç–∞—è; –∏–∑–≤–µ—Å—Ç–µ–Ω –∫–∞–∫ ¬´–∫–∏—Ä–ø–∏—á–Ω—ã–π —á–∞–π¬ª —Å –¥–æ–ª–≥–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π.", en:"Fu Zhuan is part of central-China hei cha traditions, known as a ‚Äúbrick tea‚Äù with a long history." },
      geography:{ ru:"–•—É–Ω–∞–Ω—å / –®—ç–Ω—å—Å–∏ (–≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Å—Ç–∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞).", en:"Hunan / Shaanxi (multiple regional styles exist)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~300‚Äì1500 –º (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å—ã—Ä—å—è).", en:"Often ~300‚Äì1500 m depending on leaf origin." },
      facts:{ ru:["–ò–Ω–æ–≥–¥–∞ –æ–±—Å—É–∂–¥–∞—é—Ç ¬´–∑–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç–æ–∫¬ª –∫–∞–∫ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—É—é –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–∞—Ä—Ç–∏–π.","–ú–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –æ—á–µ–Ω—å —Ä–æ–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑ —Ä–µ–∑–∫–∏—Ö –ø–∏–∫–æ–≤.","–•–æ—Ä–æ—à–æ ¬´–¥–µ—Ä–∂–∏—Ç¬ª —Ç–µ—Ä–º–æ—Å/–¥–æ—Ä–æ–∂–Ω–æ–µ –∑–∞–≤–∞—Ä–∏–≤–∞–Ω–∏–µ (–≤ –ª—ë–≥–∫–æ–π –∫—Ä–µ–ø–æ—Å—Ç–∏)."],
             en:["Some batches are known for the traditional ‚Äúgolden flower‚Äù characteristic.","Often feels very even without sharp peaks.","Works well in thermos/travel brewing when kept light."] }
    },
    agedWhite: {
      firstMention:{ ru:"–í—ã–¥–µ—Ä–∂–∏–≤–∞–Ω–∏–µ –±–µ–ª–æ–≥–æ —á–∞—è —Å—Ç–∞–ª–æ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è, —Ö–æ—Ç—è –±–µ–ª—ã–µ —á–∞–∏ –∫–∞–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏–∑–≤–µ—Å—Ç–Ω—ã –¥–∞–≤–Ω–æ.", en:"Aging white tea became widely popular in recent decades, while white tea as a category is much older." },
      geography:{ ru:"–§—É—Ü–∑—è–Ω—å, –ö–∏—Ç–∞–π (—á–∞—Å—Ç–æ –§—É–¥–∏–Ω/–ß–∂—ç–Ω—Ö—ç –∏ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏).", en:"Fujian, China (often Fuding/Zhenghe areas)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~200‚Äì1200 –º (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–æ—Ä/–¥–æ–ª–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞).", en:"Often ~200‚Äì1200 m depending on local terrain." },
      facts:{ ru:["–°–æ –≤—Ä–µ–º–µ–Ω–µ–º –∞—Ä–æ–º–∞—Ç –º–æ–∂–µ—Ç —Å–º–µ—â–∞—Ç—å—Å—è –≤ –º—ë–¥/—Å—É—Ö–æ—Ñ—Ä—É–∫—Ç—ã/—Ç—ë–ø–ª—ã–µ —Ç—Ä–∞–≤—ã.","–ú–Ω–æ–≥–∏–µ –ª—é–±—è—Ç –µ–≥–æ –≤–µ—á–µ—Ä–æ–º –∏–∑-–∑–∞ –º—è–≥–∫–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∑–∞–≤–∞—Ä–∏–≤–∞—Ç—å –Ω–µ –∫—Ä–µ–ø–∫–æ).","–°—Ç–∞—Ä–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –≤–∫—É—Å –±–æ–ª–µ–µ –æ–∫—Ä—É–≥–ª—ã–º –∏ ¬´—Å–ø–æ–∫–æ–π–Ω—ã–º¬ª."],
             en:["With age, aromas can move toward honey, dried fruit, and warm herbs.","Often enjoyed in the evening for its gentleness when brewed lightly.","Aging can make the taste rounder and calmer."] }
    },
    white: {
      firstMention:{ ru:"–ë–µ–ª—ã–µ —á–∞–∏ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ —Å–≤—è–∑—ã–≤–∞—é—Ç —Å –§—É—Ü–∑—è–Ω–æ–º; –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –≤–∏–¥–µ —Å—Ç–∏–ª–∏ –≤—Ä–æ–¥–µ –ë–∞–π –•–∞–æ –ò–Ω—å –ß–∂—ç–Ω—å —Å—Ç–∞–ª–∏ —à–∏—Ä–æ–∫–æ —É–∑–Ω–∞–≤–∞–µ–º—ã –≤ XIX‚ÄìXX –≤–≤.", en:"White teas are strongly associated with Fujian; styles like Silver Needle became widely recognized in the 19th‚Äì20th centuries." },
      geography:{ ru:"–§—É—Ü–∑—è–Ω—å, –ö–∏—Ç–∞–π (—á–∞—Å—Ç–æ –§—É–¥–∏–Ω/–ß–∂—ç–Ω—Ö—ç).", en:"Fujian, China (often Fuding/Zhenghe)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~200‚Äì1200 –º.", en:"Often ~200‚Äì1200 m." },
      facts:{ ru:["–ë–µ–ª—ã–π —á–∞–π –ª–µ–≥–∫–æ ¬´–ø–µ—Ä–µ–∫–∞–ª–∏—Ç—å¬ª ‚Äî –ª—É—á—à–µ —É–º–µ—Ä–µ–Ω–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–ª–∏–≤—ã.","–•–æ—Ä–æ—à–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω—é–∞–Ω—Å—ã –≤–æ–¥—ã: –º—è–≥–∫–∞—è –≤–æ–¥–∞ —á–∞—Å—Ç–æ –¥–∞—ë—Ç –±–æ–ª–µ–µ —Å–ª–∞–¥–∫–∏–π –≤–∫—É—Å.","–û—Ç —Å–æ—Ä—Ç–∞ (–ò–Ω—å –ß–∂—ç–Ω—å vs –ë–∞–π –ú—É –î–∞–Ω—å) –∑–∞–≤–∏—Å–∏—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∏ –∞—Ä–æ–º–∞—Ç."],
             en:["White tea can be easily overcooked‚Äîuse moderate temps and short infusions.","It reflects water quality strongly; softer water often tastes sweeter.","Cultivar/style (Silver Needle vs Bai Mu Dan) changes body and aroma."] }
    },
    hongCha: {
      firstMention:{ ru:"–ö—Ä–∞—Å–Ω—ã–µ —á–∞–∏ (–ø–æ –∫–∏—Ç–∞–π—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏) –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–≤–∏–≤–∞–ª–∏—Å—å –≤ XVIII‚ÄìXIX –≤–≤. —Å —Ä–æ—Å—Ç–æ–º —ç–∫—Å–ø–æ—Ä—Ç–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏.", en:"Chinese ‚Äòred teas‚Äô expanded strongly in the 18th‚Äì19th centuries alongside export trade." },
      geography:{ ru:"–ö–∏—Ç–∞–π (–§—É—Ü–∑—è–Ω—å, –Æ–Ω—å–Ω–∞–Ω—å, –ê–Ω—å—Ö–æ–π –∏ –¥—Ä. ‚Äî –º–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç–∏–ª–µ–π).", en:"China (Fujian, Yunnan, Anhui, etc.‚Äîmany regional styles)." },
      altitude:{ ru:"–û—á–µ–Ω—å –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ: –æ—Ç –Ω–∏–∑–∫–∏—Ö —Ö–æ–ª–º–æ–≤ –¥–æ –≥–æ—Ä–Ω—ã—Ö —Å–∞–¥–æ–≤ ~200‚Äì2000 –º.", en:"Very variable: from low hills to mountain gardens ~200‚Äì2000 m." },
      facts:{ ru:["–ß–∞—Å—Ç–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ ¬´—Ç—ë–ø–ª–∞—è –±–æ–¥—Ä–æ—Å—Ç—å¬ª –±–µ–∑ —Ä–µ–∑–∫–æ–π –Ω–µ—Ä–≤–æ–∑–Ω–æ—Å—Ç–∏.","–î–∞—ë—Ç —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä –æ—Ç –∫–∞—Ä–∞–º–µ–ª–∏/—Ö–ª–µ–±–∞ –¥–æ –∫–∞–∫–∞–æ/—Å–ø–µ—Ü–∏–π.","–û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —á–∞–π –º–µ–Ω—è–µ—Ç—Å—è –ø–æ –≤–∫—É—Å—É –ø—Ä–∏ —Ä–∞–∑–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –≤–æ–¥—ã."],
             en:["Often feels like ‚Äòwarm energy‚Äô without sharp jitteriness.","Flavor ranges from caramel/bread to cocoa/spice.","The same tea can shift notably with water temperature changes."] }
    },
    green: {
      firstMention:{ ru:"–ó–µ–ª—ë–Ω—ã–µ —á–∞–∏ –∏–º–µ—é—Ç –æ—á–µ–Ω—å –¥—Ä–µ–≤–Ω—é—é –∏—Å—Ç–æ—Ä–∏—é –≤ –ö–∏—Ç–∞–µ; –º–Ω–æ–≥–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —Å—Ç–∏–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤ —Ä–∞–∑–Ω—ã–µ —ç–ø–æ—Ö–∏, –≤–∫–ª—é—á–∞—è –ø–æ–∑–¥–Ω–∏–µ –∏–º–ø–µ—Ä—Å–∫–∏–µ –ø–µ—Ä–∏–æ–¥—ã.", en:"Green tea has a very long history in China; many famous styles were standardized across different eras." },
      geography:{ ru:"–ö–∏—Ç–∞–π (–ß–∂—ç—Ü–∑—è–Ω, –¶–∑—è–Ω—Å—É, –ê–Ω—å—Ö–æ–π –∏ –¥—Ä.).", en:"China (Zhejiang, Jiangsu, Anhui, etc.)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~200‚Äì1500 –º (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–≤–∏–Ω—Ü–∏–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≥–æ—Ä—ã).", en:"Often ~200‚Äì1500 m depending on province and mountain." },
      facts:{ ru:["–ó–µ–ª—ë–Ω—ã–π —á–∞–π —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–≤–µ–∂–µ—Å—Ç–∏: —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º –∞—Ä–æ–º–∞—Ç ¬´—Ç—É—Å–∫–Ω–µ–µ—Ç¬ª.","–ü–µ—Ä–µ–¥–µ—Ä–∂–∫–∞ –¥–∞—ë—Ç –≥–æ—Ä–µ—á—å ‚Äî –ª—É—á—à–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏.","–£—Ç—Ä–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å —è—Ä–∫–æ –∞–∫—Ç–∏–≤–∏—Ä—É—é—â–∏–º, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –ø—É—Å—Ç–æ–π –∂–µ–ª—É–¥–æ–∫."],
             en:["Freshness matters a lot: aroma can dull as it ages.","Oversteeping easily turns bitter‚Äîkeep exposures short.","Morning brewing can be very activating, especially on an empty stomach."] }
    },
    lightOolong: {
      firstMention:{ ru:"–°–≤–µ—Ç–ª—ã–µ —É–ª—É–Ω—ã (–≤ —Ç.—á. –¢–µ –ì—É–∞–Ω—å –ò–Ω—å) –ø–æ–ª—É—á–∏–ª–∏ —à–∏—Ä–æ–∫—É—é –∏–∑–≤–µ—Å—Ç–Ω–æ—Å—Ç—å –≤ XIX‚ÄìXX –≤–≤., —Ö–æ—Ç—è —É–ª—É–Ω–æ–≤—ã–µ —Ç—Ä–∞–¥–∏—Ü–∏–∏ —Å—Ç–∞—Ä—à–µ.", en:"Light oolongs (incl. Tie Guan Yin) became widely known in the 19th‚Äì20th centuries, though oolong traditions are older." },
      geography:{ ru:"–§—É—Ü–∑—è–Ω—å (–ê–Ω—å—Å–∏) –∏ –¢–∞–π–≤–∞–Ω—å (—Ä–∞–∑–Ω—ã–µ —à–∫–æ–ª—ã —Å–≤–µ—Ç–ª–æ–≥–æ —É–ª—É–Ω–∞).", en:"Fujian (Anxi) and Taiwan (different light-oolong schools)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~300‚Äì1800 –º (–æ—Å–æ–±–µ–Ω–Ω–æ —É —Ç–∞–π–≤–∞–Ω—å—Å–∫–∏—Ö –≥–æ—Ä–Ω—ã—Ö —É–ª—É–Ω–æ–≤).", en:"Often ~300‚Äì1800 m (especially Taiwan high-mountain oolongs)." },
      facts:{ ru:["–ê—Ä–æ–º–∞—Ç —á–∞—Å—Ç–æ —Ü–≤–µ—Ç–æ—á–Ω—ã–π/—Å–ª–∏–≤–æ—á–Ω—ã–π, —Å —Å–∏–ª—å–Ω–æ–π ¬´–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ–π —Å–ª–∞–¥–æ—Å—Ç—å—é¬ª.","–°–∏–ª—å–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–ª–∏–≤–∞—Ö: –ø–µ—Ä–≤—ã–µ 2‚Äì3 –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç 6‚Äì8.","–•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–Ω–µ–≤–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ –ª—ë–≥–∫–æ–≥–æ —Ç–æ–Ω—É—Å–∞."],
             en:["Often floral/creamy with strong lingering sweetness.","Infusions evolve a lot: early steeps differ from later ones.","Nice for daytime sociability and a light uplift."] }
    },
    darkOolong: {
      firstMention:{ ru:"–£–∏—à–∞–Ω—å—Å–∫–∏–µ —É–ª—É–Ω—ã –∏–∑–≤–µ—Å—Ç–Ω—ã –¥–∞–≤–Ω–æ; –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ ¬´—É—Ç—ë—Å–Ω—ã–µ¬ª —Å—Ç–∏–ª–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏—Å—å —Ç—Ä–∞–¥–∏—Ü–∏–µ–π –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤–µ–∫–æ–≤.", en:"Wuyi oolongs have a long history; classic ‚Äòrock tea‚Äô styles were shaped over centuries." },
      geography:{ ru:"–§—É—Ü–∑—è–Ω—å, –£–∏—à–∞–Ω—å (–£–∏) –∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–≥–∏–æ–Ω—ã –æ–±–∂–∞—Ä–∫–∏.", en:"Fujian, Wuyi Mountains (Wuyi) and related roast styles." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~300‚Äì1200 –º (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —É–∏—à–∞–Ω—å—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –∏ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–µ–π).", en:"Often ~300‚Äì1200 m within Wuyi mountain areas." },
      facts:{ ru:["–û–±–∂–∞—Ä–∫–∞ –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å: –æ—Ç –Ω–µ—ë –∑–∞–≤–∏—Å–∏—Ç ¬´–≥–ª—É–±–∏–Ω–∞¬ª –∏ —Å–æ–≥—Ä–µ–≤–∞—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç.","–ú–Ω–æ–≥–∏–µ —É–∏—à–∞–Ω—å—Å–∫–∏–µ —É–ª—É–Ω—ã –ª—é–±—è—Ç –∫–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–æ–ª–∏–≤—ã –∏ –∫–∏–ø—è—Ç–æ–∫.","–•–æ—Ä–æ—à–æ –¥–µ—Ä–∂–∏—Ç —Ñ–æ–∫—É—Å, –Ω–æ –≤ –ø–æ–∑–¥–Ω–∏–π –≤–µ—á–µ—Ä –ª—É—á—à–µ —É–º–µ–Ω—å—à–∞—Ç—å –¥–æ–∑—É."],
             en:["Roast level is crucial‚Äîit drives depth and warming feel.","Many Wuyi oolongs like boiling water and short infusions.","Great for focus, but reduce dose late in the day."] }
    },
    sheng: {
      firstMention:{ ru:"–®—ç–Ω –ø—É—ç—Ä ‚Äî —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ –ø—É—ç—Ä–∞; –≤—ã–¥–µ—Ä–∂–∏–≤–∞–Ω–∏–µ —à—ç–Ω–∞ –∫–∞–∫ –∫—É–ª—å—Ç—É—Ä—ã —Å–∏–ª—å–Ω–æ —Ä–∞–∑–≤–∏–ª–æ—Å—å –≤ XX‚ÄìXXI –≤–≤.", en:"Sheng pu-erh is the traditional form; aging culture expanded strongly in the 20th‚Äì21st centuries." },
      geography:{ ru:"–Æ–Ω—å–Ω–∞–Ω—å, –ö–∏—Ç–∞–π (—Ä–∞–∑–Ω—ã–µ –≥–æ—Ä—ã/—É–µ–∑–¥—ã: –æ—Ç –°–∏—à—É–∞–Ω–±–∞–Ω—å–Ω–∞ –¥–æ –õ–∏–Ω—å—Ü–∞–Ω –∏ –¥—Ä.).", en:"Yunnan, China (many mountains/counties: Xishuangbanna, Lincang, etc.)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~800‚Äì2200 –º (—É –≥–æ—Ä–Ω—ã—Ö —Å–∞–¥–æ–≤ –≤—ã—à–µ).", en:"Often ~800‚Äì2200 m (higher for mountain gardens)." },
      facts:{ ru:["–ú–æ–∂–µ—Ç –±—ã—Ç—å ¬´–æ—Å—Ç—Ä—ã–º¬ª –ø–æ –æ—â—É—â–µ–Ω–∏—é –ø—Ä–∏ —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏ ‚Äî –≤–∞–∂–Ω—ã –¥–æ–∑–∏—Ä–æ–≤–∫–∞ –∏ –µ–¥–∞.","–í—ã–¥–µ—Ä–∂–∫–∞ –æ–±—ã—á–Ω–æ —Å–º—è–≥—á–∞–µ—Ç —É–≥–ª—ã –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≥–ª—É–±–∏–Ω—É.","–ü–µ—Ä–≤—ã–µ –ø—Ä–æ–ª–∏–≤—ã —á–∞—Å—Ç–æ —Å–∞–º—ã–µ —è—Ä–∫–∏–µ –∏ ¬´–ø—Ä–æ–±—É–∂–¥–∞—é—â–∏–µ¬ª."],
             en:["Can feel sharp if you‚Äôre anxious‚Äîdose and food matter.","Aging often rounds edges and adds depth.","First infusions are often the most vivid and awakening."] }
    },
    yancha: {
      firstMention:{ ru:"–¢–µ—Ä–º–∏–Ω ¬´—è–Ω—å—á–∞¬ª —Å–≤—è–∑–∞–Ω —Å —É–∏—à–∞–Ω—å—Å–∫–æ–π —Ç—Ä–∞–¥–∏—Ü–∏–µ–π; –º–Ω–æ–≥–∏–µ ¬´—É—Ç—ë—Å–Ω—ã–µ¬ª —Å—Ç–∏–ª–∏ –∏–º–µ—é—Ç –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –¥–∞–≤–Ω—é—é —Ä–µ–ø—É—Ç–∞—Ü–∏—é.", en:"‚ÄúYancha‚Äù is tied to Wuyi tradition; many rock-tea styles carry long-standing reputations and legends." },
      geography:{ ru:"–§—É—Ü–∑—è–Ω—å, –£–∏—à–∞–Ω—å (—Å–∫–∞–ª—å–Ω—ã–µ/–≥–æ—Ä–Ω—ã–µ —Ç–µ—Ä—Ä—É–∞—Ä—ã).", en:"Fujian, Wuyi Mountains (rocky mountain terroirs)." },
      altitude:{ ru:"–ß–∞—Å—Ç–æ ~300‚Äì1200 –º (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —É–∏—à–∞–Ω—å—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞).", en:"Often ~300‚Äì1200 m in Wuyi areas." },
      facts:{ ru:["¬´–ú–∏–Ω–µ—Ä–∞–ª—å–Ω–æ—Å—Ç—å¬ª ‚Äî –æ–¥–∏–Ω –∏–∑ —Ç–∏–ø–∏—á–Ω—ã—Ö –æ–ø–∏—Å–∞—Ç–µ–ª–µ–π –≤–∫—É—Å–∞ —É —è–Ω—å—á–∞.","–û—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤–æ–¥–µ –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–ª–∏–≤–∞.","–î–∞—ë—Ç —ç—Ñ—Ñ–µ–∫—Ç ¬´—Å–æ–±—Ä–∞–Ω–Ω–æ–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏¬ª —É –º–Ω–æ–≥–∏—Ö –ª—é–¥–µ–π."],
             en:["‚ÄòMinerality‚Äô is a common descriptor for yancha taste.","Very sensitive to water quality and infusion timing.","Often associated with a ‚Äòcollected attentiveness‚Äô feel."] }
    }
  };

  // Tea details: description + pills (states it "gives" and "recommended when")
  const TEA_DETAILS = {
    shu: { desc:{ru:"–ü–ª–æ—Ç–Ω—ã–π —Ñ–µ—Ä–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É—ç—Ä: —á–∞—Å—Ç–æ –æ—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫ ¬´—Ä–æ–≤–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç¬ª –∏ –º—è–≥–∫–∞—è —Å–æ–±—Ä–∞–Ω–Ω–æ—Å—Ç—å. –ú–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–¥—Ä—è—â–∏–º, –µ—Å–ª–∏ –∑–∞–≤–∞—Ä–∏—Ç—å –∫—Ä–µ–ø–∫–æ.", en:"A fully fermented pu-erh that often feels like a ‚Äústeady base‚Äù with calm composure. Can be energizing if brewed strong."}, gives:["good5","good9","good13","good16"], when:["bad1","bad2","bad9","bad10","bad12"] },
    chaTou:{ desc:{ru:"–ü—É—ç—Ä–Ω—ã–µ ¬´–∫–∞–º—É—à–∫–∏¬ª: –æ–±—ã—á–Ω–æ –º—è–≥—á–µ –ø–æ –Ω–µ—Ä–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ, –¥–ª–∏–Ω–Ω–µ–µ ¬´–¥–µ—Ä–∂–∏—Ç¬ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ. –•–æ—Ä–æ—à –¥–ª—è —Å–ø–æ–∫–æ–π–Ω–æ–≥–æ –≤–µ—á–µ—Ä–∞ (–µ—Å–ª–∏ –Ω–µ –∫—Ä–µ–ø–∏—Ç—å).", en:"Pu-erh nuggets: often gentler, with a long-lasting steady effect. Great for an evening session (keep it light)."}, gives:["good3","good9","good15","good19","good20"], when:["bad4","bad12","bad13","bad20"] },
    liuBao:{ desc:{ru:"–•—ç–π —á–∞ –∏–∑ –ì—É–∞–Ω—Å–∏: —Ç—ë–ø–ª—ã–π, —É—Å—Ç–æ–π—á–∏–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å. –ß–∞—Å—Ç–æ –≤—ã–±–∏—Ä–∞—é—Ç –ø–æ—Å–ª–µ –µ–¥—ã –∏ –¥–ª—è ¬´—Å–æ–±—Ä–∞—Ç—å –≥–æ–ª–æ–≤—É –±–µ–∑ —Ä—ã–≤–∫–∞¬ª.", en:"Hei cha from Guangxi: warm and steady. Often chosen after food and for ‚Äúfocused stability without a spike‚Äù."}, gives:["good5","good7","good9","good16"], when:["bad1","bad2","bad9","bad17","bad10"] },
    fuZhuan:{ desc:{ru:"–•—ç–π —á–∞ (—á–∞—Å—Ç–æ –æ–±—Å—É–∂–¥–∞—é—Ç ¬´–∑–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç–æ–∫¬ª): —Ä–æ–≤–Ω–æ–µ, –º—è–≥–∫–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ, –∫–æ–≥–¥–∞ –Ω—É–∂–µ–Ω —Å–ø–æ–∫–æ–π–Ω—ã–π —Ñ–æ–Ω –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å.", en:"Hei cha often associated with a smooth, steady background‚Äîuseful when you want long, even stability."}, gives:["good5","good7","good16","good18"], when:["bad9","bad17","bad2","bad1"] },
    agedWhite:{ desc:{ru:"–í—ã–¥–µ—Ä–∂–∞–Ω–Ω—ã–π –±–µ–ª—ã–π: –º—è–≥–∫–æ ¬´–æ—á–∏—â–∞–µ—Ç –≥–æ–ª–æ–≤—É¬ª, —Å–Ω–∏–∂–∞–µ—Ç —Å—É–µ—Ç—É, —á–∞—Å—Ç–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ —Ç—ë–ø–ª–∞—è —Ç–∏—à–∏–Ω–∞ –±–µ–∑ —Ç—è–∂–µ—Å—Ç–∏.", en:"Aged white: often felt as gentle clarity with inner quiet‚Äîless mental noise, without heaviness."}, gives:["good3","good12","good15","good19","good20"], when:["bad3","bad4","bad11","bad12","bad20"] },
    white:{ desc:{ru:"–°–≤–µ–∂–∏–π –±–µ–ª—ã–π: –ª—ë–≥–∫–∏–π, –¥–µ–ª–∏–∫–∞—Ç–Ω—ã–π, —á–∞—Å—Ç–æ –¥–∞—ë—Ç –º—è–≥–∫—É—é —è—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è.", en:"Fresh white tea: light and delicate‚Äîoften a gentle lift and clarity without pressure."}, gives:["good10","good2","good7","good4"], when:["bad11","bad18","bad19"] },
    hongCha:{ desc:{ru:"–ö—Ä–∞—Å–Ω—ã–π —á–∞–π (—Ö—É–Ω —á–∞): ¬´—Ç—ë–ø–ª–∞—è –±–æ–¥—Ä–æ—Å—Ç—å¬ª –∏ —Å–æ–±—Ä–∞–Ω–Ω–æ—Å—Ç—å, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å—Å—è –±–µ–∑ —Ä–µ–∑–∫–æ–≥–æ —Å–∫–∞—á–∫–∞.", en:"Black tea (hong cha): ‚Äúwarm energy‚Äù and composed focus‚Äîgood when you want to switch on without a sharp spike."}, gives:["good4","good11","good13","good1"], when:["bad7","bad14","bad15","bad16","bad10"] },
    green:{ desc:{ru:"–ó–µ–ª—ë–Ω—ã–π: —è—Ä–∫–∞—è —è—Å–Ω–æ—Å—Ç—å –∏ –±–æ–¥—Ä–æ—Å—Ç—å. –•–æ—Ä–æ—à —É—Ç—Ä–æ–º –∏ –¥–æ –æ–±–µ–¥–∞, –Ω–æ –ø—Ä–∏ —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∞–∫—Ç–∏–≤–Ω—ã–º.", en:"Green tea: bright clarity and energy. Great in the morning; may feel too activating if you‚Äôre anxious."}, gives:["good2","good12","good8","good4"], when:["bad5","bad6","bad7","bad15"] },
    lightOolong:{ desc:{ru:"–°–≤–µ—Ç–ª—ã–π —É–ª—É–Ω: —á–∞—Å—Ç–æ —É–ª—É—á—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏ –¥–∞—ë—Ç –ª—ë–≥–∫—É—é —Å–æ–±—Ä–∞–Ω–Ω–æ—Å—Ç—å. –ö–æ–º—Ñ–æ—Ä—Ç–µ–Ω –¥–ª—è –¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã.", en:"Light oolong: often lifts mood and gives light composure‚Äîcomfortable for daytime work."}, gives:["good6","good7","good13","good4"], when:["bad6","bad18","bad8","bad15"] },
    darkOolong:{ desc:{ru:"–¢—ë–º–Ω—ã–π —É–ª—É–Ω (–£–∏): –≥–ª—É–±–∏–Ω–∞ –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è, ¬´–ø–ª–æ—Ç–Ω—ã–π¬ª —Ñ–æ–∫—É—Å. –£–º–µ—Å—Ç–µ–Ω –¥–Ω—ë–º, –≤–µ—á–µ—Ä–æ–º ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å –∫—Ä–µ–ø–æ—Å—Ç—å—é.", en:"Dark oolong (Wuyi): depth and concentration‚Äîoften a ‚Äúdense focus‚Äù. Use carefully in the evening (strength matters)."}, gives:["good1","good8","good14","good11"], when:["bad8","bad14","bad15","bad2"] },
    sheng:{ desc:{ru:"–®—ç–Ω –ø—É—ç—Ä: —á–∏—Å—Ç–∞—è –±–æ–¥—Ä–æ—Å—Ç—å –∏ —Ñ–æ–∫—É—Å, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å ¬´–æ—Å—Ç—Ä—ã–º¬ª –¥–ª—è —Ç—Ä–µ–≤–æ–∂–Ω—ã—Ö/—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö. –õ—É—á—à–µ –¥–æ 14:00.", en:"Sheng pu-erh: clean energy and focus, but can feel sharp for anxious/sensitive people. Best before 2pm."}, gives:["good2","good1","good4","good14"], when:["bad5","bad6","bad7","bad16"] },
    yancha:{ desc:{ru:"–Ø–Ω—å—á–∞: —Å–æ–±—Ä–∞–Ω–Ω–æ—Å—Ç—å –∏ –≥–ª—É–±–æ–∫–∞—è –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –ß–∞—Å—Ç–æ –≤—ã–±–∏—Ä–∞—é—Ç, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ ¬´–≤–∫–ª—é—á–∏—Ç—å –º–æ–∑–≥¬ª –∏ –¥–µ—Ä–∂–∞—Ç—å –ª–∏–Ω–∏—é.", en:"Yancha: composed focus and deep attentiveness‚Äîoften chosen when you want ‚Äúbrain on‚Äù for a sustained stretch."}, gives:["good1","good8","good13","good14"], when:["bad8","bad14","bad2","bad16"] }
  };

  // =========================
  // State texts (20 + 20)
  // =========================
  const STATE_TEXT = {
    bad1:{ru:"–§–∏–∑–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–ª–æ—Å—Ç—å",en:"Physical fatigue"},
    bad2:{ru:"–ú–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å",en:"Mental overload"},
    bad3:{ru:"–†–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",en:"Irritability"},
    bad4:{ru:"–¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å",en:"Anxiety"},
    bad5:{ru:"–°–æ–Ω–ª–∏–≤–æ—Å—Ç—å —É—Ç—Ä–æ–º",en:"Morning sleepiness"},
    bad6:{ru:"–¢—É–º–∞–Ω –≤ –≥–æ–ª–æ–≤–µ",en:"Brain fog"},
    bad7:{ru:"–í—è–ª–æ—Å—Ç—å –∏ –∏–Ω–µ—Ä—Ç–Ω–æ—Å—Ç—å",en:"Sluggishness"},
    bad8:{ru:"–†–∞—Å—Ñ–æ–∫—É—Å",en:"Lack of focus"},
    bad9:{ru:"–ü–µ—Ä–µ–µ–¥–∞–Ω–∏–µ / —Ç—è–∂–µ—Å—Ç—å",en:"Overeating / heaviness"},
    bad10:{ru:"–•–æ–ª–æ–¥ –≤ —Ç–µ–ª–µ",en:"Feeling cold"},
    bad11:{ru:"–ü–µ—Ä–µ–≥—Ä–µ–≤ / ‚Äú–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∂–∞—Ä‚Äù",en:"Overheated / ‚Äúinner heat‚Äù"},
    bad12:{ru:"–°—É–µ—Ç–∞ –≤ –≥–æ–ª–æ–≤–µ",en:"Mind racing"},
    bad13:{ru:"–ù–µ—Ä–≤–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ",en:"Nervous tension"},
    bad14:{ru:"–ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏—è",en:"Procrastination"},
    bad15:{ru:"–ü–æ—Å–ª–µ–æ–±–µ–¥–µ–Ω–Ω—ã–π —Å–ø–∞–¥",en:"Afternoon slump"},
    bad16:{ru:"–ù–∏–∑–∫–∞—è –º–æ—Ç–∏–≤–∞—Ü–∏—è",en:"Low motivation"},
    bad17:{ru:"–†–∞–∑–¥—É—Ç—ã–π –∂–∏–≤–æ—Ç",en:"Bloating"},
    bad18:{ru:"–ü–ª–æ—Ö–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ",en:"Low mood"},
    bad19:{ru:"–£—Å—Ç–∞–ª–æ—Å—Ç—å –≥–ª–∞–∑/—ç–∫—Ä–∞–Ω—ã",en:"Eye strain (screens)"},
    bad20:{ru:"–ë–µ—Å—Å–æ–Ω–Ω–∞—è –≥–æ–ª–æ–≤–∞ –≤–µ—á–µ—Ä–æ–º",en:"Restless head at night"},

    good1:{ru:"–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–Ω–æ—Å—Ç—å",en:"Concentration"},
    good2:{ru:"–Ø—Å–Ω–æ—Å—Ç—å",en:"Clarity"},
    good3:{ru:"–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ",en:"Calm"},
    good4:{ru:"–ú—è–≥–∫–∞—è –±–æ–¥—Ä–æ—Å—Ç—å",en:"Gentle energy"},
    good5:{ru:"–¢—ë–ø–ª–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å",en:"Warm steadiness"},
    good6:{ru:"–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫",en:"Creative flow"},
    good7:{ru:"–†–æ–≤–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ",en:"Even mood"},
    good8:{ru:"–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å",en:"Attentiveness"},
    good9:{ru:"–ó–∞–∑–µ–º–ª–µ–Ω–∏–µ",en:"Grounding"},
    good10:{ru:"–õ—ë–≥–∫–æ—Å—Ç—å",en:"Lightness"},
    good11:{ru:"–¢—ë–ø–ª–∞—è —ç–Ω–µ—Ä–≥–∏—è",en:"Warm energy"},
    good12:{ru:"–ß–∏—Å—Ç–∞—è –≥–æ–ª–æ–≤–∞",en:"Clear head"},
    good13:{ru:"–°–æ–±—Ä–∞–Ω–Ω–æ—Å—Ç—å –±–µ–∑ —Å—Ç—Ä–µ—Å—Å–∞",en:"Composed (no stress)"},
    good14:{ru:"–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å",en:"Confidence"},
    good15:{ru:"–ú–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å",en:"Meditative mood"},
    good16:{ru:"–í—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å (—Å–ø–æ–∫–æ–π–Ω–∞—è)",en:"Steady endurance"},
    good17:{ru:"–ö–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å",en:"Sociability"},
    good18:{ru:"–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ",en:"Recovery"},
    good19:{ru:"–¢–∏—à–∏–Ω–∞ –≤–Ω—É—Ç—Ä–∏",en:"Inner quiet"},
    good20:{ru:"–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–æ —Å–Ω—É",en:"Ready for sleep"},
  };
  function TState(id, lang){ return (STATE_TEXT[id] && STATE_TEXT[id][lang]) ? STATE_TEXT[id][lang] : id; }

  // =========================
  // Recommendations mapping
  // =========================
  const badStates = [
    {id:"bad1",  teas:[TEA.shu, TEA.liuBao, TEA.hongCha, TEA.agedWhite]},
    {id:"bad2",  teas:[TEA.shu, TEA.agedWhite, TEA.liuBao, TEA.darkOolong]},
    {id:"bad3",  teas:[TEA.agedWhite, TEA.chaTou, TEA.liuBao, TEA.shu]},
    {id:"bad4",  teas:[TEA.chaTou, TEA.agedWhite, TEA.liuBao, TEA.shu]},
    {id:"bad5",  teas:[TEA.green, TEA.sheng, TEA.lightOolong, TEA.hongCha]},
    {id:"bad6",  teas:[TEA.green, TEA.lightOolong, TEA.sheng, TEA.hongCha]},
    {id:"bad7",  teas:[TEA.hongCha, TEA.green, TEA.darkOolong, TEA.sheng]},
    {id:"bad8",  teas:[TEA.darkOolong, TEA.hongCha, TEA.shu, TEA.yancha]},
    {id:"bad9",  teas:[TEA.liuBao, TEA.fuZhuan, TEA.shu, TEA.darkOolong]},
    {id:"bad10", teas:[TEA.hongCha, TEA.shu, TEA.darkOolong, TEA.liuBao]},
    {id:"bad11", teas:[TEA.white, TEA.agedWhite, TEA.green, TEA.lightOolong]},
    {id:"bad12", teas:[TEA.agedWhite, TEA.chaTou, TEA.liuBao, TEA.shu]},
    {id:"bad13", teas:[TEA.chaTou, TEA.agedWhite, TEA.liuBao, TEA.shu]},
    {id:"bad14", teas:[TEA.hongCha, TEA.darkOolong, TEA.green, TEA.sheng]},
    {id:"bad15", teas:[TEA.darkOolong, TEA.hongCha, TEA.shu, TEA.liuBao]},
    {id:"bad16", teas:[TEA.hongCha, TEA.yancha, TEA.sheng, TEA.lightOolong]},
    {id:"bad17", teas:[TEA.liuBao, TEA.fuZhuan, TEA.shu, TEA.darkOolong]},
    {id:"bad18", teas:[TEA.lightOolong, TEA.hongCha, TEA.green, TEA.white]},
    {id:"bad19", teas:[TEA.agedWhite, TEA.white, TEA.liuBao, TEA.shu]},
    {id:"bad20", teas:[TEA.chaTou, TEA.agedWhite, TEA.liuBao, TEA.shu]},
  ];
  const goodStates = [
    {id:"good1",  teas:[TEA.yancha, TEA.darkOolong, TEA.hongCha, TEA.shu]},
    {id:"good2",  teas:[TEA.green, TEA.sheng, TEA.lightOolong, TEA.white]},
    {id:"good3",  teas:[TEA.chaTou, TEA.agedWhite, TEA.liuBao, TEA.shu]},
    {id:"good4",  teas:[TEA.hongCha, TEA.lightOolong, TEA.green, TEA.sheng]},
    {id:"good5",  teas:[TEA.shu, TEA.liuBao, TEA.fuZhuan, TEA.hongCha]},
    {id:"good6",  teas:[TEA.lightOolong, TEA.sheng, TEA.green, TEA.hongCha]},
    {id:"good7",  teas:[TEA.agedWhite, TEA.hongCha, TEA.liuBao, TEA.lightOolong]},
    {id:"good8",  teas:[TEA.darkOolong, TEA.yancha, TEA.hongCha, TEA.shu]},
    {id:"good9",  teas:[TEA.chaTou, TEA.shu, TEA.liuBao, TEA.fuZhuan]},
    {id:"good10", teas:[TEA.white, TEA.green, TEA.lightOolong, TEA.agedWhite]},
    {id:"good11", teas:[TEA.hongCha, TEA.darkOolong, TEA.shu, TEA.liuBao]},
    {id:"good12", teas:[TEA.green, TEA.sheng, TEA.white, TEA.lightOolong]},
    {id:"good13", teas:[TEA.hongCha, TEA.darkOolong, TEA.shu, TEA.agedWhite]},
    {id:"good14", teas:[TEA.yancha, TEA.darkOolong, TEA.hongCha, TEA.sheng]},
    {id:"good15", teas:[TEA.agedWhite, TEA.chaTou, TEA.liuBao, TEA.white]},
    {id:"good16", teas:[TEA.shu, TEA.liuBao, TEA.fuZhuan, TEA.hongCha]},
    {id:"good17", teas:[TEA.lightOolong, TEA.hongCha, TEA.green, TEA.white]},
    {id:"good18", teas:[TEA.agedWhite, TEA.chaTou, TEA.liuBao, TEA.shu]},
    {id:"good19", teas:[TEA.chaTou, TEA.agedWhite, TEA.liuBao, TEA.shu]},
    {id:"good20", teas:[TEA.chaTou, TEA.agedWhite, TEA.liuBao, TEA.shu]},
  ];
  const badById  = Object.fromEntries(badStates.map(s=>[s.id, s]));
  const goodById = Object.fromEntries(goodStates.map(s=>[s.id, s]));

  // =========================
  // ‚ÄúAI‚Äù keyword matcher (local)
  // =========================
  const KEYWORDS = {
    bad: {
      bad1:  ["—É—Å—Ç–∞–ª", "—É—Å—Ç–∞–ª–æ—Å—Ç—å", "–≤—ã–º–æ—Ç", "—Ä–∞–∑–±–∏—Ç", "fatigue", "tired", "exhaust"],
      bad2:  ["–ø–µ—Ä–µ–≥—Ä—É–∑", "–ø–µ—Ä–µ–≥—Ä—É–∂", "—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ", "–º–Ω–æ–≥–æ –∑–∞–¥–∞—á", "overload", "overwhelmed"],
      bad3:  ["—Ä–∞–∑–¥—Ä–∞–∂", "–∑–ª—é—Å—å", "–±–µ—Å–∏—Ç", "irritab", "annoy", "angry"],
      bad4:  ["—Ç—Ä–µ–≤–æ–≥", "—Ç—Ä–µ–≤–æ–∂–Ω–æ", "–ø–∞–Ω–∏–∫", "anxiety", "anxious", "panic"],
      bad5:  ["—Å–æ–Ω–ª–∏–≤", "–∫–ª–æ–Ω–∏—Ç", "–Ω–µ –ø—Ä–æ—Å–Ω—É–ª", "sleepy", "drowsy", "morning"],
      bad6:  ["—Ç—É–º–∞–Ω", "–≤–∞—Ç–Ω–∞—è", "–Ω–µ —Å–æ–æ–±—Ä–∞–∂", "brain fog", "foggy", "cloudy head"],
      bad7:  ["–≤—è–ª", "–∏–Ω–µ—Ä—Ç", "–ª–µ–Ω", "sluggish", "lazy", "no energy"],
      bad8:  ["—Ä–∞—Å—Ñ–æ–∫—É—Å", "–Ω–µ –º–æ–≥—É —Å–æ—Å—Ä–µ–¥", "—Ä–∞–∑–±—Ä–æ—Å", "distract", "no focus"],
      bad9:  ["—Ç—è–∂–µ—Å—Ç—å", "–ø–µ—Ä–µ–µ–ª", "–ø–ª–æ—Ç–Ω–æ –ø–æ–µ–ª", "overeat", "heavy stomach"],
      bad10: ["—Ö–æ–ª–æ–¥–Ω–æ", "–∑—è–±–∫–æ", "–º–µ—Ä–∑–Ω—É", "cold", "chilly"],
      bad11: ["–∂–∞—Ä", "–ø–µ—Ä–µ–≥—Ä–µ–≤", "–≥–æ—Ä—è—á–æ", "–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∂–∞—Ä", "hot", "overheated"],
      bad12: ["—Å—É–µ—Ç–∞", "–º—ã—Å–ª–∏ —Å–∫–∞—á—É—Ç", "–≥–æ–Ω—è–µ—Ç –º—ã—Å–ª–∏", "mind racing", "racing thoughts"],
      bad13: ["–Ω–∞–ø—Ä—è–∂", "–Ω–µ—Ä–≤—ã", "—Å—Ç—Ä–µ—Å—Å", "tension", "nervous", "stressed"],
      bad14: ["–ø—Ä–æ–∫—Ä–∞—Å—Ç", "–æ—Ç–∫–ª–∞–¥—ã", "–Ω–µ –º–æ–≥—É –Ω–∞—á–∞—Ç—å", "procrast", "delay"],
      bad15: ["–ø–æ—Å–ª–µ –æ–±–µ–¥–∞", "–ø–æ—Å–ª–µ–æ–±–µ–¥", "—Å–ø–∞–¥", "afternoon slump", "after lunch"],
      bad16: ["–Ω–µ—Ç –º–æ—Ç–∏–≤–∞", "–∞–ø–∞—Ç–∏—è", "–Ω–µ —Ö–æ—á—É", "low motivation", "no motivation"],
      bad17: ["–≤–∑–¥—É—Ç", "–∂–∏–≤–æ—Ç", "–≥–∞–∑", "bloat", "bloating"],
      bad18: ["–ø–ª–æ—Ö–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", "–≥—Ä—É—Å—Ç—å", "—É–Ω—ã–Ω–∏–µ", "low mood", "sad"],
      bad19: ["–≥–ª–∞–∑–∞", "—ç–∫—Ä–∞–Ω—ã", "–º–æ–Ω–∏—Ç–æ—Ä", "eye strain", "screen"],
      bad20: ["–Ω–µ —É—Å–Ω—É—Ç—å", "–±–µ—Å—Å–æ–Ω", "–≥–æ–ª–æ–≤–∞ –Ω–µ –≤—ã–∫–ª—é—á", "insomnia", "cant sleep", "restless night"],
    },
    good: {
      good1:  ["—Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á", "—Ñ–æ–∫—É—Å", "concentration", "focus"],
      good2:  ["—è—Å–Ω–æ—Å—Ç—å", "—á–∏—Å—Ç–∞—è –≥–æ–ª–æ–≤–∞", "clarity", "clear"],
      good3:  ["—Å–ø–æ–∫–æ–π", "calm", "relax"],
      good4:  ["–±–æ–¥—Ä", "—ç–Ω–µ—Ä–≥", "gentle energy", "energized"],
      good5:  ["—É—Å—Ç–æ–π—á–∏–≤", "—Ä–æ–≤–Ω–æ", "steady", "grounded warm"],
      good6:  ["—Ç–≤–æ—Ä", "–∫—Ä–µ–∞—Ç–∏–≤", "flow", "creative"],
      good7:  ["—Ä–æ–≤–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–æ–≤–Ω–æ", "even mood", "balanced mood"],
      good8:  ["–≤–Ω–∏–º–∞—Ç–µ–ª—å", "–æ—Å–æ–∑–Ω–∞–Ω", "attentive", "mindful"],
      good9:  ["–∑–∞–∑–µ–º–ª", "ground", "grounding"],
      good10: ["–ª—ë–≥–∫–æ—Å—Ç—å", "–ª–µ–≥–∫–æ", "lightness", "light"],
      good11: ["—Ç—ë–ø–ª–∞—è —ç–Ω–µ—Ä–≥–∏—è", "—Ç–µ–ø–ª–æ", "warm energy", "warmth"],
      good12: ["clear head", "—Å–æ–±—Ä–∞–Ω", "–±–µ–∑ —Ç—É–º–∞–Ω–∞"],
      good13: ["–±–µ–∑ —Å—Ç—Ä–µ—Å—Å–∞", "—Å–ø–æ–∫–æ–π–Ω—ã–π —Ñ–æ–∫—É—Å", "composed", "no stress"],
      good14: ["—É–≤–µ—Ä–µ–Ω", "confidence", "confident"],
      good15: ["–º–µ–¥–∏—Ç–∞—Ç–∏–≤", "—Ç–∏—à–∏–Ω–∞", "meditative", "zen"],
      good16: ["–≤—ã–Ω–æ—Å–ª–∏–≤", "–¥–æ–ª–≥–æ", "endurance", "stamina"],
      good17: ["–æ–±—â–∏—Ç–µ–ª", "–∫–æ–º–º—É–Ω–∏–∫–∞", "sociable", "social"],
      good18: ["–≤–æ—Å—Å—Ç–∞–Ω–æ–≤", "recovery", "recover"],
      good19: ["–≤–Ω—É—Ç—Ä–∏ —Ç–∏—Ö–æ", "—Ç–∏—à–∏–Ω–∞ –≤–Ω—É—Ç—Ä–∏", "inner quiet", "quiet inside"],
      good20: ["–∫–æ —Å–Ω—É", "–∑–∞—Å–Ω—É—Ç—å", "ready for sleep", "sleep ready"],
    }
  };

  function scoreText(text, words){
    const t = text.toLowerCase();
    let s = 0;
    const hits = [];
    for(const w of words){
      if(t.includes(w.toLowerCase())){
        s += 1;
        hits.push(w);
      }
    }
    return {score:s, hits};
  }

  function analyzeFreeText(text){
    const t = (text || "").trim();
    const result = { bad: [], good: [] };
    if(!t) return result;

    const badScored = [];
    for(const id in KEYWORDS.bad){
      const r = scoreText(t, KEYWORDS.bad[id]);
      if(r.score > 0) badScored.push({id, score:r.score, hits:r.hits});
    }
    badScored.sort((a,b)=> b.score - a.score);

    const goodScored = [];
    for(const id in KEYWORDS.good){
      const r = scoreText(t, KEYWORDS.good[id]);
      if(r.score > 0) goodScored.push({id, score:r.score, hits:r.hits});
    }
    goodScored.sort((a,b)=> b.score - a.score);

    result.bad = badScored.slice(0,5);
    result.good = goodScored.slice(0,5);
    return result;
  }

  // =========================
  // Ozon link helper
  // =========================
  function ozonSearchUrl(q){
    return `https://www.ozon.ru/search/?text=${encodeURIComponent(q)}`;
  }

  // =========================
  // DOM
  // =========================
  const badCloud  = document.getElementById("badCloud");
  const goodCloud = document.getElementById("goodCloud");

  const rightCard = document.getElementById("rightCard");

  const cardTitle = document.getElementById("cardTitle");
  const cardChip  = document.getElementById("cardChip");
  const cardDesc  = document.getElementById("cardDesc");
  const teaList   = document.getElementById("teaList");

  const reasoningBox = document.getElementById("reasoningBox");
  const reasoningText = document.getElementById("reasoningText");
  const hideWhyBtn = document.getElementById("hideWhyBtn");

  const multiBlocks       = document.getElementById("multiBlocks");
  const selectedBadChips  = document.getElementById("selectedBadChips");
  const selectedGoodChips = document.getElementById("selectedGoodChips");

  const multiToggle = document.getElementById("multiToggle");
  const counterText = document.getElementById("counterText");

  const clearBadBtn  = document.getElementById("clearBadBtn");
  const clearGoodBtn = document.getElementById("clearGoodBtn");
  const clearAllBtn  = document.getElementById("clearAllBtn");

  const limitModal     = document.getElementById("limitModal");
  const closeLimitBtn  = document.getElementById("closeLimitBtn");

  const proModal = document.getElementById("proModal");
  const proModalEnable = document.getElementById("proModalEnable");
  const proModalCancel = document.getElementById("proModalCancel");
  const proModalCloseX = document.getElementById("proModalCloseX");

  const aboutLink = document.getElementById("aboutLink");
  const aboutModal = document.getElementById("aboutModal");
  const aboutCloseBtn = document.getElementById("aboutCloseBtn");

  const langSelect = document.getElementById("langSelect");
  const themeBtn   = document.getElementById("themeBtn");

  const nlpInput = document.getElementById("nlpInput");
  const nlpBtn   = document.getElementById("nlpBtn");

  // tea modal
  const teaModal = document.getElementById("teaModal");
  const teaModalCloseBtn = document.getElementById("teaModalCloseBtn");
  const teaModalTitle = document.getElementById("teaModalTitle");
  const teaModalDesc = document.getElementById("teaModalDesc");
  const teaModalOriginTitle = document.getElementById("teaModalOriginTitle");
  const teaModalOrigin = document.getElementById("teaModalOrigin");
  const teaModalFactsTitle = document.getElementById("teaModalFactsTitle");
  const teaModalFacts = document.getElementById("teaModalFacts");
  const teaModalGivesTitle = document.getElementById("teaModalGivesTitle");
  const teaModalWhenTitle = document.getElementById("teaModalWhenTitle");
  const teaModalBrewTitle = document.getElementById("teaModalBrewTitle");
  const teaModalGives = document.getElementById("teaModalGives");
  const teaModalWhen = document.getElementById("teaModalWhen");
  const teaModalBrew = document.getElementById("teaModalBrew");

  // =========================
  // App state
  // =========================
  let lang = "ru";
  let multiMode = false;
  const selectedBad  = new Set();
  const selectedGood = new Set();
  let lastReasoning = "";
  let pendingEnablePro = false;

  // =========================
  // Modals
  // =========================
  function openModal(el){ el.style.display = "flex"; }
  function closeModal(el){ el.style.display = "none"; }

  closeLimitBtn.addEventListener("click", ()=>closeModal(limitModal));
  limitModal.addEventListener("click", (e)=>{ if(e.target === limitModal) closeModal(limitModal); });

  proModalCancel.addEventListener("click", ()=>{ pendingEnablePro = false; closeModal(proModal); });
  proModalCloseX.addEventListener("click", ()=>{ pendingEnablePro = false; closeModal(proModal); });
  proModal.addEventListener("click", (e)=>{ if(e.target === proModal) { pendingEnablePro = false; closeModal(proModal); } });

  teaModalCloseBtn.addEventListener("click", ()=>closeModal(teaModal));
  teaModal.addEventListener("click", (e)=>{ if(e.target === teaModal) closeModal(teaModal); });

  // About modal
  aboutLink.addEventListener("click", ()=> openModal(aboutModal));
  aboutCloseBtn.addEventListener("click", ()=> closeModal(aboutModal));
  aboutModal.addEventListener("click", (e)=>{ if(e.target === aboutModal) closeModal(aboutModal); });

  // =========================
  // Helpers
  // =========================
  function teaName(tea){ return tea.name[lang] || tea.name.en || tea.name.ru; }
  function teaTag(tea){ return tea.tag[lang] || tea.tag.en || tea.tag.ru; }
  function teaBrew(tea){ return tea.brew[lang] || tea.brew.en || tea.brew.ru; }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function updateCounter(){
    counterText.textContent = UI[lang].counter(selectedBad.size, selectedGood.size);
  }

  function resetSingleView(){
    document.querySelectorAll(".node").forEach(b=> b.dataset.active = "false");
    cardTitle.textContent = UI[lang].cardIdleTitle;
    cardDesc.textContent = UI[lang].cardDesc;
    teaList.innerHTML = "";
    hideReasoning();
  }

  function showReasoning(text){
    if(!text || !text.trim()){
      hideReasoning();
      return;
    }
    lastReasoning = text;
    reasoningText.innerHTML = text;
    reasoningBox.style.display = "block";
    hideWhyBtn.textContent = UI[lang].hide;
    document.getElementById("uiWhy").textContent = UI[lang].why;
  }
  function hideReasoning(){ reasoningBox.style.display = "none"; }
  hideWhyBtn.addEventListener("click", ()=> hideReasoning());

  function renderPills(target, ids, kind){
    target.innerHTML = "";
    if(!ids || !ids.length){
      const s = document.createElement("span");
      s.className = "muted";
      s.textContent = "‚Äî";
      target.appendChild(s);
      return;
    }
    ids.forEach(id=>{
      const p = document.createElement("span");
      p.className = `pillState ${kind}`;
      p.textContent = TState(id, lang);
      target.appendChild(p);
    });
  }

  function openTeaDetails(teaKey){
    const tea = TEA[teaKey];
    const det = TEA_DETAILS[teaKey];
    const meta = TEA_META[teaKey];

    teaModalTitle.textContent = tea ? teaName(tea) : "Tea";
    teaModalDesc.textContent = det?.desc?.[lang] || det?.desc?.en || "";

    teaModalOriginTitle.textContent = UI[lang].teaModal.originTitle;
    teaModalFactsTitle.textContent  = UI[lang].teaModal.factsTitle;

    const originParts = [];
    if(meta?.firstMention?.[lang] || meta?.firstMention?.en) originParts.push(meta.firstMention[lang] || meta.firstMention.en);
    if(meta?.geography?.[lang] || meta?.geography?.en) originParts.push(meta.geography[lang] || meta.geography.en);
    if(meta?.altitude?.[lang] || meta?.altitude?.en) originParts.push(meta.altitude[lang] || meta.altitude.en);
    teaModalOrigin.textContent = originParts.join(" ");

    const factsArr = meta?.facts?.[lang] || meta?.facts?.en || [];
    teaModalFacts.innerHTML = factsArr.length
      ? `<ul style="margin:6px 0 0; padding-left:18px;">${factsArr.map(f=>`<li>${escapeHtml(f)}</li>`).join("")}</ul>`
      : "‚Äî";

    teaModalGivesTitle.textContent = UI[lang].teaModal.givesTitle;
    teaModalWhenTitle.textContent  = UI[lang].teaModal.whenTitle;
    teaModalBrewTitle.textContent  = UI[lang].teaModal.brewTitle;

    renderPills(teaModalGives, det?.gives || [], "good");
    renderPills(teaModalWhen,  det?.when  || [], "bad");

    teaModalBrew.textContent = tea ? teaBrew(tea) : "";

    openModal(teaModal);
  }

  function highlightRightCard(){
    window.scrollTo({ top: 0, behavior: "smooth" });
    rightCard.classList.remove("flashGreen");
    void rightCard.offsetWidth;
    rightCard.classList.add("flashGreen");
    rightCard.classList.add("keepGreen");
  }

  // =========================
  // Render clouds
  // =========================
  function renderCloud(list, targetEl, type){
    targetEl.innerHTML = "";
    list.forEach(item=>{
      const btn = document.createElement("button");
      btn.className = `node ${type}`;
      btn.dataset.id = item.id;
      btn.dataset.type = type;
      btn.dataset.active = "false";
      btn.dataset.selected = "false";
      btn.innerHTML = `${escapeHtml(TState(item.id, lang))}<span class="checkdot"></span>`;
      btn.addEventListener("click", ()=> onStateClick(item, btn, type));
      targetEl.appendChild(btn);
    });
  }

  function renderSelectedChips(){
    selectedBadChips.innerHTML = "";
    if(selectedBad.size === 0){
      const t = document.createElement("span");
      t.className = "muted";
      t.textContent = "‚Äî";
      selectedBadChips.appendChild(t);
    } else {
      [...selectedBad].forEach(id=>{
        const s = document.createElement("span");
        s.className = "stateChip bad";
        s.textContent = TState(id, lang);
        selectedBadChips.appendChild(s);
      });
    }

    selectedGoodChips.innerHTML = "";
    if(selectedGood.size === 0){
      const t = document.createElement("span");
      t.className = "muted";
      t.textContent = "‚Äî";
      selectedGoodChips.appendChild(t);
    } else {
      [...selectedGood].forEach(id=>{
        const s = document.createElement("span");
        s.className = "stateChip good";
        s.textContent = TState(id, lang);
        selectedGoodChips.appendChild(s);
      });
    }
  }

  function aggregateTeas(states){
    const score = new Map();
    states.forEach(st=>{
      st.teas.slice(0,4).forEach(t=>{
        const cur = score.get(t.key);
        if(cur) cur.count += 1;
        else score.set(t.key, {tea: t, count: 1});
      });
    });
    return [...score.values()].sort((a,b)=> (b.count - a.count) || teaName(a.tea).localeCompare(teaName(b.tea)));
  }

  async function renderTeaList(items){
    teaList.innerHTML = "";
    for(const it of items){
      const tea = it.tea;
      const count = it.count;
      const url = ozonSearchUrl(tea.q);

      const li = document.createElement("li");
      li.innerHTML = `
        <div class="k">
          <span>
            <button class="teaBtn" type="button" data-tea-key="${tea.key}">
              ${escapeHtml(teaName(tea))}
            </button>
          </span>
          <span class="tag">${escapeHtml(teaTag(tea))}${count ? ` ‚Ä¢ ${count}` : ""}</span>
        </div>
        <div class="muted">${escapeHtml(teaBrew(tea))}</div>
        <div class="buyLine">
          <a class="buyLink" href="${url}" target="_blank" rel="noopener">${escapeHtml(UI[lang].buy)}</a>
        </div>
      `;
      teaList.appendChild(li);

      li.querySelector(`button[data-tea-key="${tea.key}"]`)
        .addEventListener("click", ()=> openTeaDetails(tea.key));
    }
  }

  function renderMultiRecommendations(){
    if(selectedBad.size === 0 && selectedGood.size === 0){
      cardTitle.textContent = UI[lang].cardIdleTitle;
      cardDesc.textContent = UI[lang].cardDesc;
      teaList.innerHTML = "";
      if(lastReasoning) showReasoning(lastReasoning);
      return;
    }

    cardTitle.textContent = UI[lang].prompts.proTitle;
    cardDesc.textContent = UI[lang].prompts.proDesc;

    const badSel  = [...selectedBad].map(id=>badById[id]).filter(Boolean);
    const goodSel = [...selectedGood].map(id=>goodById[id]).filter(Boolean);

    const merged = aggregateTeas([...badSel, ...goodSel]).slice(0,12);
    void renderTeaList(merged);

    if(lastReasoning) showReasoning(lastReasoning);
  }

  // =========================
  // Mode switching
  // =========================
  function setMode(nextMulti){
    multiMode = nextMulti;

    multiToggle.dataset.on = String(nextMulti);
    multiToggle.setAttribute("aria-checked", String(nextMulti));

    cardChip.textContent = nextMulti ? UI[lang].cardModePro : UI[lang].cardModeSingle;

    if(nextMulti){
      document.querySelectorAll(".node").forEach(b=> b.dataset.active = "false");
      multiBlocks.style.display = "block";
      renderSelectedChips();
      renderMultiRecommendations();
    } else {
      selectedBad.clear();
      selectedGood.clear();
      document.querySelectorAll(".node").forEach(b=> b.dataset.selected = "false");
      multiBlocks.style.display = "none";
      resetSingleView();
      lastReasoning = "";
    }
    updateCounter();
  }

  function requestEnablePro(){
    pendingEnablePro = true;
    document.getElementById("uiProModalTitle").textContent = UI[lang].proModalTitle;
    document.getElementById("uiProModalBody").textContent = UI[lang].proModalBody;
    proModalEnable.textContent = UI[lang].proModalEnable;
    proModalCancel.textContent = UI[lang].proModalCancel;
    openModal(proModal);
  }

  function toggleModeWithModal(){
    if(!multiMode){
      requestEnablePro();
    } else {
      setMode(false);
    }
  }

  proModalEnable.addEventListener("click", ()=>{
    closeModal(proModal);
    if(!pendingEnablePro) return;
    pendingEnablePro = false;
    setMode(true);
  });

  multiToggle.addEventListener("click", toggleModeWithModal);
  multiToggle.addEventListener("keydown", (e)=>{
    if(e.key === "Enter" || e.key === " "){
      e.preventDefault();
      toggleModeWithModal();
    }
  });

  // =========================
  // Click handler
  // =========================
  function onStateClick(item, btn, type){
    if(!multiMode){
      document.querySelectorAll(".node").forEach(b=> b.dataset.active = "false");
      btn.dataset.active = "true";

      cardTitle.textContent = TState(item.id, lang);
      cardDesc.textContent = (type === "bad") ? UI[lang].prompts.bad : UI[lang].prompts.good;

      const list = item.teas.slice(0,4).map(tea=>({tea, count:null}));
      void renderTeaList(list);

      if(lastReasoning) showReasoning(lastReasoning);
      else hideReasoning();

      return;
    }

    const set = (type === "bad") ? selectedBad : selectedGood;
    const isSelected = btn.dataset.selected === "true";

    if(isSelected){
      set.delete(item.id);
      btn.dataset.selected = "false";
    } else {
      if(set.size >= 5){
        openModal(limitModal);
        return;
      }
      set.add(item.id);
      btn.dataset.selected = "true";
    }

    renderSelectedChips();
    renderMultiRecommendations();
    updateCounter();
  }

  // =========================
  // Free-text ‚ÄúAI‚Äù button
  // =========================
  function clearSelectionsUI(){
    document.querySelectorAll(".node").forEach(b=>{
      b.dataset.selected = "false";
      b.dataset.active = "false";
    });
  }

  function selectState(id, type){
    const btn = document.querySelector(`.node.${type}[data-id="${id}"]`);
    if(btn) btn.dataset.selected = "true";
  }

  function buildReasoningText(inputText, analyzed){
    const esc = escapeHtml;
    const lines = [];

    lines.push(`<div><b>${lang==="ru" ? "–¢–≤–æ–π —Ç–µ–∫—Å—Ç:" : "Your text:"}</b> ${esc(inputText)}</div>`);

    if(analyzed.bad.length === 0 && analyzed.good.length === 0){
      lines.push(`<div style="margin-top:6px;">${esc(lang==="ru"
        ? "–ù–µ –Ω–∞—à—ë–ª —è–≤–Ω—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ ‚Äî –ø–æ–ø—Ä–æ–±—É–π –æ–ø–∏—Å–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ–µ (—Å–æ–Ω–ª–∏–≤–æ—Å—Ç—å, —Ç—Ä–µ–≤–æ–≥–∞, —Ç—É–º–∞–Ω –≤ –≥–æ–ª–æ–≤–µ, –ø–æ—Å–ª–µ –æ–±–µ–¥–∞, —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ç.–¥.)."
        : "No strong keyword matches ‚Äî try being more specific (sleepy, anxious, brain fog, after lunch, irritated, etc.).")}</div>`);
      return lines.join("");
    }

    function fmtBlock(title, arr){
      if(arr.length === 0) return;
      lines.push(`<div style="margin-top:8px;"><b>${esc(title)}</b></div>`);
      lines.push(`<ul style="margin:6px 0 0; padding-left:18px;">` +
        arr.map(x=>{
          const name = esc(TState(x.id, lang));
          const hits = x.hits.slice(0,5).map(h=>`‚Äú${esc(h)}‚Äù`).join(", ");
          const score = x.score;
          const hitText = hits ? ` ‚Äî ${esc(lang==="ru" ? "–Ω–∞–π–¥–µ–Ω–æ" : "matched")}: ${hits}` : "";
          return `<li>${name} <span style="color:var(--muted);">(${score})${hitText}</span></li>`;
        }).join("") +
      `</ul>`);
    }

    fmtBlock(lang==="ru" ? "–û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (—É–±—Ä–∞—Ç—å)" : "Detected states (reduce)", analyzed.bad);
    fmtBlock(lang==="ru" ? "–û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–≤—ã–∑–≤–∞—Ç—å)" : "Detected states (evoke)", analyzed.good);

    lines.push(`<div style="margin-top:8px; color:var(--muted); font-size:12px;">${
      esc(lang==="ru"
        ? "–õ–æ–∫–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (—Å–ª–æ–≤–∞—Ä—å –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø—Ä—è–º–æ –≤ –∫–æ–¥–µ)."
        : "Local keyword-based matcher (you can expand the dictionary in the code).")
    }</div>`);

    return lines.join("");
  }

  function ensureProOnForAI(){
    if(multiMode) return;
    setMode(true);
  }

  nlpBtn.addEventListener("click", ()=>{
    const text = (nlpInput.value || "").trim();
    if(!text) return;

    const analyzed = analyzeFreeText(text);

    ensureProOnForAI();
    selectedBad.clear();
    selectedGood.clear();
    clearSelectionsUI();

    analyzed.bad.forEach(x=> selectedBad.add(x.id));
    analyzed.good.forEach(x=> selectedGood.add(x.id));

    [...selectedBad].slice(0,5).forEach(id=>selectState(id, "bad"));
    [...selectedGood].slice(0,5).forEach(id=>selectState(id, "good"));

    renderSelectedChips();
    updateCounter();

    lastReasoning = buildReasoningText(text, analyzed);

    const totalStates = analyzed.bad.length + analyzed.good.length;

    if(totalStates === 1){
      const one = analyzed.bad[0]?.id || analyzed.good[0]?.id;
      const isBad = !!analyzed.bad[0];

      cardChip.textContent = UI[lang].cardModePro;
      cardTitle.textContent = TState(one, lang);
      cardDesc.textContent = isBad ? UI[lang].prompts.bad : UI[lang].prompts.good;

      const item = isBad ? badById[one] : goodById[one];
      const list = item.teas.slice(0,4).map(tea=>({tea, count:null}));
      void renderTeaList(list);

      multiBlocks.style.display = "block";
      showReasoning(lastReasoning);

      highlightRightCard();
      return;
    }

    multiBlocks.style.display = "block";
    renderMultiRecommendations();
    showReasoning(lastReasoning);

    highlightRightCard();
  });

  nlpInput.addEventListener("keydown", (e)=>{
    if(e.key === "Enter"){
      e.preventDefault();
      nlpBtn.click();
    }
  });

  // =========================
  // Language + theme
  // =========================
  function detectLang(){
    const raw = (navigator.language || "en").toLowerCase();
    return raw.startsWith("ru") ? "ru" : "en";
  }

  function applyThemeButtonLabel(){
    const theme = document.documentElement.getAttribute("data-theme") || "light";
    themeBtn.textContent = (theme === "light") ? UI[lang].themeLight : UI[lang].themeDark;
  }

  function setTheme(next){
    document.documentElement.setAttribute("data-theme", next);
    localStorage.setItem("tea_states_theme", next);
    applyThemeButtonLabel();
  }

  themeBtn.addEventListener("click", ()=>{
    const cur = document.documentElement.getAttribute("data-theme") || "light";
    setTheme(cur === "light" ? "dark" : "light");
  });

  function applyUI(){
    const u = UI[lang];
    document.documentElement.lang = lang;

    document.getElementById("uiTitle").textContent = u.title;
    document.getElementById("uiSubtitle").textContent = u.subtitle;
    document.getElementById("uiLangLabel").textContent = u.langLabel;

    document.getElementById("uiBadTitle").textContent = u.badTitle;
    document.getElementById("uiBadHint").textContent = u.badHint;
    document.getElementById("uiBadPill").textContent = u.badPill;

    document.getElementById("uiGoodTitle").textContent = u.goodTitle;
    document.getElementById("uiGoodHint").textContent = u.goodHint;
    document.getElementById("uiGoodPill1").textContent = u.goodPill1;
    document.getElementById("uiGoodPill2").textContent = u.goodPill2;

    document.getElementById("uiAddedRemove").textContent = u.addedRemove;
    document.getElementById("uiAddedGet").textContent = u.addedGet;
    document.getElementById("uiTeaPick").textContent = u.teaPick;
    document.getElementById("uiMultiLine").textContent = u.multiLine;

    clearBadBtn.textContent = u.clear;
    clearGoodBtn.textContent = u.clear;
    clearAllBtn.textContent = u.resetAll;

    document.getElementById("uiBrewQuick").innerHTML = u.quickBrew;

    document.getElementById("uiProTitle").textContent = u.proTitle;
    document.getElementById("uiFineprint").textContent = u.fineprint;
    aboutLink.textContent = u.about;

    document.getElementById("uiAboutTitle").textContent = u.aboutTitle;
    document.getElementById("uiAboutBody").textContent = u.aboutBody;

    document.getElementById("uiLimitTitle").textContent = u.limitTitle;
    document.getElementById("uiLimitBody").textContent = u.limitBody;
    closeLimitBtn.textContent = u.ok;

    document.getElementById("uiNlpTitle").textContent = u.nlpTitle;
    nlpInput.placeholder = u.nlpPlaceholder;
    nlpBtn.textContent = u.nlpBtn;
    document.getElementById("uiNlpNote").textContent = u.nlpNote;

    document.getElementById("uiProModalTitle").textContent = u.proModalTitle;
    document.getElementById("uiProModalBody").textContent = u.proModalBody;
    proModalEnable.textContent = u.proModalEnable;
    proModalCancel.textContent = u.proModalCancel;

    teaModalCloseBtn.textContent = u.ok;
    teaModalOriginTitle.textContent = u.teaModal.originTitle;
    teaModalFactsTitle.textContent  = u.teaModal.factsTitle;
    teaModalGivesTitle.textContent  = u.teaModal.givesTitle;
    teaModalWhenTitle.textContent   = u.teaModal.whenTitle;
    teaModalBrewTitle.textContent   = u.teaModal.brewTitle;

    renderCloud(badStates, badCloud, "bad");
    renderCloud(goodStates, goodCloud, "good");

    if(multiMode){
      [...selectedBad].forEach(id=>selectState(id, "bad"));
      [...selectedGood].forEach(id=>selectState(id, "good"));
      renderSelectedChips();
      renderMultiRecommendations();
    } else {
      resetSingleView();
    }
    updateCounter();
    applyThemeButtonLabel();

    if(lastReasoning){
      showReasoning(lastReasoning);
    }
  }

  function fillLangSelect(){
    langSelect.innerHTML = "";
    LANGS.forEach(l=>{
      const opt = document.createElement("option");
      opt.value = l.id;
      opt.textContent = l.label;
      langSelect.appendChild(opt);
    });
  }

  function setLang(next){
    if(!UI[next]) return;
    lang = next;
    localStorage.setItem("tea_states_lang", lang);
    langSelect.value = lang;
    applyUI();
  }
  langSelect.addEventListener("change", ()=> setLang(langSelect.value));

  // =========================
  // Init
  // =========================
  function init(){
    fillLangSelect();

    const savedLang = localStorage.getItem("tea_states_lang");
    lang = savedLang || ((navigator.language || "en").toLowerCase().startsWith("ru") ? "ru" : "en");
    langSelect.value = lang;

    const savedTheme = localStorage.getItem("tea_states_theme");
    setTheme(savedTheme || "light");

    setMode(false);
    applyUI();
  }

  init();

  // Extra: Tea click wiring (delegation safe fallback)
  document.addEventListener("click", (e)=>{
    const btn = e.target.closest && e.target.closest(".teaBtn");
    if(btn && btn.dataset && btn.dataset.teaKey){
      openTeaDetails(btn.dataset.teaKey);
    }
  });
</script>
</body>
</html>
